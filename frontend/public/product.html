<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Details - Peekaboo Shades</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* ============================================
       PEEKABOO SHADES - Product Detail Page
       Matching Figma Design 100%
       ============================================ */

    :root {
      --golden-brown: #8E6545;
      --golden-brown-dark: #8E6545;
      --dark-brown: #8E6545;
      --text-dark: #333333;
      --text-brown: #8E6545;
      --text-light: #666666;
      --text-muted: #999999;
      --bg-cream: #F8F6F3;
      --bg-light: #FAFAFA;
      --bg-white: #FFFFFF;
      --border-light: #E8E8E8;
      --border-medium: #D4D4D4;
      --success-green: #28a745;
      --error-red: #dc3545;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      font-size: 14px;
      line-height: 1.7;
      color: #8E6545;
      background-color: #F6F1EB;
      font-weight: 400;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }

    a {
      text-decoration: none;
      color: inherit;
      transition: color 0.2s ease;
    }

    button {
      cursor: pointer;
      border: none;
      background: none;
      font-family: 'Montserrat', sans-serif;
    }

    input, select, textarea {
      font-family: 'Montserrat', sans-serif;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Montserrat', sans-serif;
      letter-spacing: -0.02em;
      font-weight: 600;
    }

    /* ============================================
       TOP BAR
       ============================================ */
    .top-bar {
      background-color: var(--dark-brown);
      color: white;
      padding: 8px 0;
      font-size: 12px;
    }

    .top-bar-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .top-bar-left {
      display: flex;
      gap: 25px;
    }

    .top-bar-left span {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .top-bar-center {
      display: flex;
      gap: 20px;
    }

    .top-bar-center a {
      color: white;
      font-weight: 500;
    }

    .top-bar-right {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .top-bar-right a {
      color: white;
      display: flex;
      align-items: center;
      gap: 5px;
    }

    /* ============================================
       MAIN HEADER
       ============================================ */
    .main-header {
      background-color: #FFFFFF;
      height: 120px;
      display: flex;
      align-items: center;
      border-bottom: 1px solid var(--border-light);
    }

    .header-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .logo-img {
      height: 100px !important;
      width: auto !important;
      border-radius: 8px;
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      background: var(--golden-brown);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .logo-icon svg {
      width: 24px;
      height: 24px;
      fill: white;
    }

    .logo-text {
      font-size: 18px;
      font-weight: 700;
      color: var(--golden-brown);
    }

    .logo-text span {
      color: var(--dark-brown);
    }

    .main-nav ul {
      display: flex;
      gap: 30px;
      list-style: none;
    }

    .main-nav a {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-dark);
      display: flex;
      align-items: center;
      gap: 5px;
      letter-spacing: 0.02em;
    }

    .main-nav a:hover {
      color: var(--golden-brown);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .search-box {
      display: flex;
      align-items: center;
      background: var(--bg-light);
      border: 1px solid var(--border-light);
      border-radius: 25px;
      padding: 8px 15px;
      width: 200px;
    }

    .search-box input {
      border: none;
      background: none;
      outline: none;
      flex: 1;
      font-size: 13px;
    }

    .search-box i {
      color: var(--text-muted);
    }

    .header-icons {
      display: flex;
      gap: 15px;
    }

    .header-icon {
      position: relative;
      color: var(--text-dark);
      font-size: 18px;
    }

    .cart-count {
      position: absolute;
      top: -8px;
      right: -8px;
      background: var(--golden-brown);
      color: white;
      font-size: 10px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }

    /* ============================================
       PRODUCT DETAIL SECTION
       ============================================ */
    .product-detail-section {
      padding: 30px 0 50px;
      background: #F6F1EB;
    }

    .product-detail-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 40px;
      display: grid;
      grid-template-columns: 500px 1fr;
      gap: 50px;
    }

    /* Layout: Gallery on Right (Configurator on Left) */
    .product-detail-container.layout-gallery-right {
      grid-template-columns: 1fr 500px;
    }

    .product-detail-container.layout-gallery-right .product-gallery {
      order: 2;
    }

    .product-detail-container.layout-gallery-right .product-info {
      order: 1;
    }

    /* Product Gallery */
    .product-gallery {
      position: sticky;
      top: 20px;
      height: fit-content;
    }

    .gallery-wrapper {
      display: flex;
      gap: 15px;
    }

    .thumbnail-column {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .thumb-item {
      width: 70px;
      height: 70px;
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }

    .thumb-item:hover,
    .thumb-item.active {
      border-color: var(--golden-brown);
    }

    .thumb-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .main-image {
      flex: 1;
      border-radius: 12px;
      overflow: hidden;
      background: var(--bg-light);
    }

    .main-image img {
      width: 100%;
      height: 400px;
      object-fit: cover;
    }

    /* Product Info */
    .product-info {
      padding-top: 10px;
    }

    /* Select Shades Dropdown */
    .select-shades-dropdown {
      position: relative;
      display: inline-block;
      margin-bottom: 15px;
    }

    .select-shades-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 18px;
      background: var(--bg-white);
      border: 1px solid var(--border-medium);
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      color: var(--golden-brown);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .select-shades-btn:hover {
      border-color: var(--golden-brown);
      background: var(--bg-light);
      transform: translateY(-2px);
    }

    .select-shades-btn i {
      font-size: 10px;
      transition: transform 0.3s ease;
    }

    .select-shades-dropdown.open .select-shades-btn i {
      transform: rotate(180deg);
    }

    .select-shades-menu {
      position: absolute;
      top: 100%;
      left: 0;
      margin-top: 5px;
      background: var(--bg-white);
      border: 1px solid var(--border-light);
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      min-width: 220px;
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-10px);
      transition: all 0.3s ease;
    }

    .select-shades-dropdown.open .select-shades-menu {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .select-shades-menu a {
      display: block;
      padding: 12px 18px;
      font-size: 13px;
      color: var(--text-dark);
      border-bottom: 1px solid var(--border-light);
      transition: all 0.3s ease;
    }

    .select-shades-menu a:last-child {
      border-bottom: none;
    }

    .select-shades-menu a:hover {
      background: var(--bg-light);
      color: var(--golden-brown);
    }

    .select-shades-menu a.active {
      background: var(--golden-brown);
      color: white;
    }

    .breadcrumb-label {
      color: var(--golden-brown);
      font-size: 12px;
      font-weight: 500;
      margin-bottom: 12px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .product-title {
      font-size: 26px;
      font-weight: 600;
      color: var(--text-brown);
      line-height: 1.35;
      margin-bottom: 16px;
      letter-spacing: -0.02em;
    }

    .product-description {
      font-size: 14px;
      color: var(--text-light);
      line-height: 1.75;
      margin-bottom: 24px;
      font-weight: 400;
    }

    .product-price-container {
      display: flex;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }

    .product-price-container.position-above {
      flex-direction: column;
      gap: 4px;
    }

    .price-label {
      font-size: 13px;
      color: #666666;
      font-weight: 500;
      letter-spacing: 0.01em;
    }

    .product-price {
      font-size: 28px;
      font-weight: 700;
      color: var(--text-dark);
      letter-spacing: -0.02em;
    }

    /* Configuration Section */
    .config-section {
      margin-bottom: 20px;
    }

    .config-label {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 10px;
      display: block;
      letter-spacing: 0.02em;
    }

    .config-label .required {
      color: var(--error-red);
      font-weight: 500;
    }

    /* Dimension Inputs */
    .dimension-row {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }

    .dimension-group {
      flex: 1;
    }

    .dimension-group label {
      display: block;
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 5px;
    }

    .dimension-input-wrapper {
      display: flex;
      width: 100%;
      max-width: 280px;
      height: 56px;
      border: 1px solid #E8E4E0;
      border-radius: 10px;
      overflow: hidden;
      background: #FFFFFF;
    }

    .dimension-input-wrapper input {
      flex: 1;
      padding: 14px 18px;
      border: none;
      outline: none;
      font-size: 16px;
      color: #333333;
      background: #FFFFFF;
      width: 100%;
      font-weight: 500;
    }

    .dimension-input-wrapper input::placeholder {
      color: #999999;
    }

    .dimension-input-wrapper .unit {
      padding: 14px 18px;
      background: #F5F0EB;
      color: #8E6545;
      font-size: 15px;
      display: flex;
      align-items: center;
      border-left: 1px solid #E8E4E0;
      font-weight: 500;
    }

    /* Select Dropdown */
    .config-select {
      width: 100%;
      padding: 16px 18px;
      border: 1px solid #E8E4E0;
      border-radius: 10px;
      font-size: 15px;
      color: #000000;
      background: #FFFFFF;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%238E6545' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 18px center;
      font-weight: 500;
      height: 56px;
    }

    .config-select:focus {
      border-color: #8E6545;
      outline: none;
    }

    .config-select option {
      color: #000000;
    }

    /* Accordion Sections */
    .accordion-section {
      width: 100%;
      border: 1px solid #E8E4E0;
      border-radius: 16px;
      margin-bottom: 15px;
      overflow: hidden;
      background: #FFFFFF;
    }

    .accordion-section.open {
      height: auto;
    }

    .accordion-header {
      width: 100%;
      min-height: 68px;
      padding: 20px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #F5F0EB;
      font-size: 15px;
      font-weight: 600;
      color: #8E6545;
      text-align: left;
      cursor: pointer;
      transition: background 0.3s ease;
      letter-spacing: 0.01em;
    }

    .accordion-header:hover {
      background: #EDE6DF;
    }

    .accordion-header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .accordion-selected {
      font-size: 14px;
      color: #8E6545;
      font-weight: 400;
      opacity: 0.7;
    }

    .accordion-icon {
      font-size: 24px;
      color: #8E6545;
      transition: transform 0.3s ease;
      font-weight: 300;
    }

    .accordion-icon::before {
      content: '+';
      font-family: 'Montserrat', sans-serif;
      font-weight: 300;
    }

    .accordion-section.open .accordion-icon::before {
      content: '−';
    }

    .accordion-section.open .accordion-icon {
      transform: none;
    }

    .accordion-body {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, padding 0.3s ease;
      padding: 0 25px;
      background: #FFFFFF;
    }

    .accordion-section.open .accordion-body {
      max-height: 2000px;
      padding: 20px 25px 25px;
    }

    /* Color/Material Swatches */
    .swatch-row {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 18px;
    }

    .swatch-label {
      font-size: 13px;
      color: #8E6545;
      margin-bottom: 12px;
      display: block;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .color-swatch {
      width: 107px;
      height: 110px;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid #E5E5E5;
      transition: all 0.2s ease;
      position: relative;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .color-swatch:hover {
      border-color: #8E6545;
      transform: scale(1.05);
    }

    .color-swatch.selected {
      border-color: #8E6545;
      border-width: 3px;
      box-shadow: 0 0 0 2px rgba(142, 101, 69, 0.3);
    }

    .color-swatch.selected::after {
      content: '\2713';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #FFFFFF;
      font-size: 16px;
      font-weight: bold;
      text-shadow: 0 1px 2px rgba(0,0,0,0.5);
    }

    .material-swatch {
      width: 55px;
      height: 45px;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid #E5E5E5;
      overflow: hidden;
      transition: all 0.2s ease;
    }

    .material-swatch:hover,
    .material-swatch.selected {
      border-color: #8E6545;
    }

    .material-swatch img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Hardware Options */
    .hardware-group {
      margin-bottom: 18px;
    }

    .hardware-label {
      font-size: 13px;
      color: #8E6545;
      margin-bottom: 12px;
      display: block;
      font-weight: 600;
      letter-spacing: 0.02em;
    }

    .hardware-swatches {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .hardware-swatch {
      width: 55px;
      height: 45px;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid #E5E5E5;
      overflow: hidden;
      transition: all 0.2s ease;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .hardware-swatch:hover {
      border-color: #8E6545;
      transform: scale(1.05);
    }

    .hardware-swatch.selected {
      border-color: #8E6545;
      border-width: 3px;
      box-shadow: 0 0 0 2px rgba(142, 101, 69, 0.3);
    }

    .hardware-swatch img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Quantity & Warranty Row */
    .quantity-warranty-row {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      margin-top: 25px;
    }

    .quantity-group {
      flex: 1;
    }

    .quantity-input {
      display: flex;
      align-items: center;
      border: 1px solid var(--border-medium);
      border-radius: 8px;
      overflow: hidden;
    }

    .quantity-btn {
      width: 45px;
      height: 45px;
      background: var(--bg-light);
      font-size: 18px;
      color: var(--text-dark);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.3s ease;
    }

    .quantity-btn:hover {
      background: var(--border-light);
    }

    .quantity-input input {
      flex: 1;
      text-align: center;
      padding: 12px;
      border: none;
      outline: none;
      font-size: 14px;
      font-weight: 500;
    }

    .warranty-group {
      flex: 1;
    }

    .warranty-checkbox {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 15px;
      border: 1px solid var(--border-medium);
      border-radius: 8px;
      cursor: pointer;
      height: 47px;
    }

    .warranty-checkbox input {
      display: none;
    }

    .checkbox-custom {
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-medium);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: transparent;
      transition: all 0.3s ease;
    }

    .warranty-checkbox input:checked + .checkbox-custom {
      background: var(--golden-brown);
      border-color: var(--golden-brown);
      color: white;
    }

    .warranty-text {
      font-size: 12px;
      color: var(--text-dark);
    }

    /* Price Summary */
    .price-summary {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 30px;
      margin-bottom: 20px;
      padding: 15px 0;
      border-top: 1px solid var(--border-light);
    }

    .price-label {
      font-size: 14px;
      color: var(--text-dark);
      font-weight: 500;
    }

    .sale-price {
      font-size: 32px;
      font-weight: 700;
      color: var(--golden-brown);
      letter-spacing: -0.02em;
    }

    /* Action Buttons */
    .action-buttons {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
    }

    .btn-add-cart {
      flex: 1;
      padding: 16px 28px;
      background: var(--golden-brown);
      color: white;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      transition: all 0.3s ease;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }

    .btn-add-cart:hover {
      background: var(--golden-brown-dark);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(142, 101, 69, 0.3);
    }

    .btn-quote {
      flex: 1;
      padding: 16px 28px;
      border: 2px solid var(--golden-brown);
      color: var(--golden-brown);
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      background: transparent;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      transition: all 0.3s ease;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }

    .btn-quote:hover {
      background: var(--golden-brown);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(142, 101, 69, 0.3);
    }

    /* Shop Pay Button */
    .shop-pay-btn {
      width: 100%;
      padding: 15px;
      background: #5A31F4;
      color: white;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
      transition: all 0.3s ease;
    }

    .shop-pay-btn:hover {
      background: #4A21E4;
      transform: translateY(-2px);
    }

    /* Share Button */
    .share-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text-muted);
      font-size: 13px;
      padding: 10px 0;
    }

    .share-btn:hover {
      color: var(--golden-brown);
    }

    /* ============================================
       PRODUCT DETAILS SECTION
       ============================================ */
    .product-details-section {
      padding: 50px 0;
      background: #F6F1EB;
    }

    .product-details-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 40px;
    }

    .product-details-accordion {
      background: #FFFFFF;
      border: 1px solid #E8E4E0;
      border-radius: 20px;
      overflow: hidden;
      margin-bottom: 15px;
    }

    .product-details-header {
      width: 100%;
      padding: 24px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #F5F0EB;
      font-size: 17px;
      font-weight: 600;
      color: #8E6545;
      cursor: pointer;
      transition: background 0.3s ease;
      letter-spacing: 0.01em;
    }

    .product-details-header:hover {
      background: #EDE6DF;
    }

    .product-details-icon {
      font-size: 26px;
      color: #8E6545;
      font-weight: 300;
    }

    .product-details-accordion.open .product-details-icon {
      content: '−';
    }

    .product-details-body {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      background: #FFFFFF;
    }

    .product-details-accordion.open .product-details-body {
      max-height: 2000px;
    }

    .details-content {
      padding: 25px 30px;
    }

    .details-content h4 {
      font-size: 15px;
      font-weight: 600;
      color: #8E6545;
      margin-bottom: 14px;
      margin-top: 22px;
      letter-spacing: 0.02em;
    }

    .details-content h4:first-child {
      margin-top: 0;
    }

    .details-content ul {
      list-style: disc;
      margin-left: 20px;
      color: #666666;
      font-size: 14px;
      line-height: 1.85;
      font-weight: 400;
    }

    .details-content p {
      color: #666666;
      font-size: 14px;
      line-height: 1.8;
      font-weight: 400;
    }

    /* Catalog Content Styles */
    .catalog-content {
      padding: 30px;
    }

    .catalog-section {
      margin-bottom: 30px;
      padding-bottom: 25px;
      border-bottom: 1px solid #E8E4E0;
    }

    .catalog-section:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .catalog-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .catalog-item {
      background: #F6F1EB;
      padding: 15px;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .catalog-item strong {
      color: #8E6545;
      font-size: 14px;
    }

    .catalog-item span {
      color: #666666;
      font-size: 13px;
    }

    .catalog-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      font-size: 13px;
    }

    .catalog-table th,
    .catalog-table td {
      padding: 12px 15px;
      text-align: left;
      border: 1px solid #E8E4E0;
    }

    .catalog-table th {
      background: #8E6545;
      color: white;
      font-weight: 600;
    }

    .catalog-table tr:nth-child(even) {
      background: #F6F1EB;
    }

    .catalog-table tr:hover {
      background: #EDE6DF;
    }

    .catalog-note {
      margin-top: 15px;
      padding: 15px;
      background: #FFF8E7;
      border-left: 4px solid #8E6545;
      border-radius: 0 8px 8px 0;
      font-size: 13px;
    }

    /* ============================================
       FAQ SECTION
       ============================================ */
    .faq-section {
      padding: 50px 0;
      background: var(--bg-cream);
    }

    .faq-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 40px;
    }

    .faq-subtitle {
      color: var(--text-muted);
      font-size: 12px;
      margin-bottom: 8px;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      font-weight: 500;
    }

    .faq-title {
      font-size: 28px;
      font-weight: 600;
      color: var(--text-brown);
      margin-bottom: 32px;
      letter-spacing: -0.02em;
    }

    .faq-item {
      background: var(--bg-white);
      border-radius: 10px;
      margin-bottom: 12px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    .faq-question {
      width: 100%;
      padding: 18px 22px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 15px;
      font-weight: 500;
      color: var(--text-brown);
      background: var(--bg-white);
      text-align: left;
      letter-spacing: 0.01em;
    }

    .faq-question:hover {
      background: var(--bg-light);
    }

    .faq-icon {
      font-size: 20px;
      color: var(--golden-brown);
      transition: transform 0.3s ease;
    }

    .faq-item.active .faq-icon {
      transform: rotate(45deg);
    }

    .faq-answer {
      padding: 0 22px;
      max-height: 0;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .faq-item.active .faq-answer {
      padding: 0 22px 18px;
      max-height: 300px;
    }

    .faq-answer p {
      color: var(--text-light);
      font-size: 13px;
      line-height: 1.7;
    }

    /* ============================================
       EXPLORE TRENDS SECTION
       ============================================ */
    .trends-section {
      padding: 50px 0;
      background: #F6F1EB;
    }

    .trends-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 40px;
    }

    .trends-subtitle {
      color: var(--text-muted);
      font-size: 12px;
      margin-bottom: 8px;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      font-weight: 500;
    }

    .trends-title {
      font-size: 28px;
      font-weight: 600;
      color: var(--text-brown);
      margin-bottom: 32px;
      letter-spacing: -0.02em;
    }

    .trends-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 25px;
    }

    .product-card {
      background: var(--bg-white);
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 1px solid var(--border-light);
    }

    .product-card:hover {
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      transform: translateY(-5px);
    }

    .product-card-image {
      position: relative;
      padding-top: 100%;
      background: var(--bg-light);
      overflow: hidden;
    }

    .product-card-image img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .product-card:hover .product-card-image img {
      transform: scale(1.05);
    }

    .product-card-info {
      padding: 18px;
    }

    .product-card-title {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-dark);
      margin-bottom: 10px;
      line-height: 1.45;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      letter-spacing: 0.01em;
    }

    .product-card-price {
      font-size: 16px;
      font-weight: 600;
      color: var(--golden-brown);
      letter-spacing: -0.01em;
    }

    /* ============================================
       FOOTER
       ============================================ */
    .main-footer {
      background: var(--bg-cream);
      padding: 50px 0 30px;
    }

    .footer-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 40px;
    }

    .footer-grid {
      display: grid;
      grid-template-columns: 1.5fr 1fr 1fr 1fr 1fr;
      gap: 40px;
      margin-bottom: 40px;
    }

    .footer-brand {
      padding-right: 30px;
    }

    .footer-logo {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 15px;
    }

    .footer-logo .logo-img,
    .footer-brand .logo-img {
      height: 80px !important;
      width: auto !important;
    }

    .footer-logo .logo-icon {
      width: 35px;
      height: 35px;
    }

    .footer-logo .logo-text {
      font-size: 16px;
    }

    .footer-description {
      font-size: 12px;
      color: var(--text-light);
      line-height: 1.7;
      margin-bottom: 20px;
    }

    .footer-social {
      display: flex;
      gap: 10px;
    }

    .social-icon {
      width: 32px;
      height: 32px;
      background: var(--bg-white);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-dark);
      font-size: 14px;
      transition: all 0.3s ease;
    }

    .social-icon:hover {
      background: var(--golden-brown);
      color: white;
    }

    .footer-column h4 {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 20px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .footer-column ul {
      list-style: none;
    }

    .footer-column ul li {
      margin-bottom: 12px;
    }

    .footer-column ul a {
      font-size: 14px;
      color: var(--text-light);
      font-weight: 400;
      letter-spacing: 0.01em;
    }

    .footer-column ul a:hover {
      color: var(--golden-brown);
    }

    .footer-bottom {
      border-top: 1px solid var(--border-light);
      padding-top: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .footer-copyright {
      font-size: 12px;
      color: var(--text-muted);
    }

    .footer-links {
      display: flex;
      gap: 20px;
    }

    .footer-links a {
      font-size: 12px;
      color: var(--text-muted);
    }

    .footer-links a:hover {
      color: var(--golden-brown);
    }

    /* ============================================
       MODALS
       ============================================ */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--bg-white);
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
    }

    .modal-header {
      padding: 20px;
      border-bottom: 1px solid var(--border-light);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-header h3 {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-brown);
      letter-spacing: -0.01em;
    }

    .modal-close {
      width: 32px;
      height: 32px;
      background: var(--bg-light);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: var(--text-dark);
      transition: all 0.3s ease;
    }

    .modal-close:hover {
      background: var(--border-light);
    }

    .modal-body {
      padding: 20px;
    }

    .form-group {
      margin-bottom: 18px;
    }

    .form-group label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-dark);
      margin-bottom: 8px;
      letter-spacing: 0.02em;
    }

    .form-group input,
    .form-group textarea {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid var(--border-medium);
      border-radius: 8px;
      font-size: 14px;
      outline: none;
    }

    .form-group input:focus,
    .form-group textarea:focus {
      border-color: var(--golden-brown);
    }

    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }

    .submit-btn {
      width: 100%;
      padding: 16px;
      background: var(--golden-brown);
      color: white;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s ease;
      letter-spacing: 0.03em;
      text-transform: uppercase;
    }

    .submit-btn:hover {
      background: var(--golden-brown-dark);
      box-shadow: 0 6px 20px rgba(142, 101, 69, 0.3);
    }

    /* Toast */
    .toast-container {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 3000;
    }

    .toast {
      background: var(--text-dark);
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      margin-top: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      gap: 10px;
      animation: slideIn 0.3s ease;
    }

    .toast.success {
      background: var(--success-green);
    }

    .toast.error {
      background: var(--error-red);
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
        max-height: 0;
      }
      to {
        opacity: 1;
        transform: translateY(0);
        max-height: 200px;
      }
    }

    /* Image Zoom Modal */
    .zoom-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 10000;
      justify-content: center;
      align-items: center;
      animation: fadeIn 0.3s ease;
    }

    .zoom-modal.active {
      display: flex;
    }

    .zoom-modal-content {
      position: relative;
      max-width: 90%;
      max-height: 90%;
      text-align: center;
    }

    .zoom-modal-content img {
      max-width: 100%;
      max-height: 80vh;
      border-radius: 12px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      transition: transform 0.3s ease;
      cursor: grab;
    }

    .zoom-modal-content img:active {
      cursor: grabbing;
    }

    .zoom-close {
      position: absolute;
      top: -40px;
      right: -10px;
      width: 40px;
      height: 40px;
      background: #ffffff;
      border: none;
      border-radius: 50%;
      font-size: 28px;
      color: #333;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }

    .zoom-close:hover {
      background: #8E6545;
      color: #ffffff;
      transform: rotate(90deg);
    }

    .zoom-caption {
      color: #ffffff;
      font-size: 15px;
      font-weight: 500;
      margin-top: 15px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      letter-spacing: 0.02em;
    }

    .zoom-controls {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }

    .zoom-btn {
      width: 44px;
      height: 44px;
      background: rgba(255, 255, 255, 0.15);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 10px;
      color: #ffffff;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }

    .zoom-btn:hover {
      background: #8E6545;
      border-color: #8E6545;
      transform: scale(1.1);
    }

    .zoomable-image {
      position: relative;
      cursor: zoom-in;
    }

    .zoomable-image::after {
      content: '';
      position: absolute;
      top: 5px;
      right: 5px;
      width: 22px;
      height: 22px;
      background: rgba(142, 101, 69, 0.9);
      border-radius: 50%;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='2.5'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='M21 21l-4.35-4.35'/%3E%3Cpath d='M11 8v6m-3-3h6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: center;
      background-size: 14px;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }

    .zoomable-image:hover::after {
      opacity: 1;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* ============================================
       RESPONSIVE
       ============================================ */
    @media (max-width: 1200px) {
      .trends-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .footer-grid {
        grid-template-columns: repeat(3, 1fr);
      }

      .footer-brand {
        grid-column: span 3;
      }
    }

    @media (max-width: 992px) {
      .product-detail-container {
        grid-template-columns: 1fr;
      }

      .product-gallery {
        position: static;
      }

      .main-nav {
        display: none;
      }
    }

    @media (max-width: 768px) {
      .top-bar-container {
        flex-direction: column;
        gap: 10px;
      }

      .header-container {
        flex-wrap: wrap;
      }

      .search-box {
        order: 3;
        width: 100%;
        margin-top: 10px;
      }

      .gallery-wrapper {
        flex-direction: column-reverse;
      }

      .thumbnail-column {
        flex-direction: row;
        justify-content: center;
      }

      .footer-grid {
        grid-template-columns: repeat(2, 1fr);
      }

      .footer-brand {
        grid-column: span 2;
      }
    }

    @media (max-width: 576px) {
      .trends-grid {
        grid-template-columns: 1fr;
      }

      .footer-grid {
        grid-template-columns: 1fr;
      }

      .footer-brand {
        grid-column: span 1;
      }

      .dimension-row {
        flex-direction: column;
      }

      .action-buttons {
        flex-direction: column;
      }

      .quantity-warranty-row {
        flex-direction: column;
      }

      .price-summary {
        flex-direction: column;
        align-items: flex-start;
        gap: 10px;
      }
    }

    /* Custom Scrollbar for Fabric Swatches */
    .fabric-group::-webkit-scrollbar {
      width: 8px;
    }
    .fabric-group::-webkit-scrollbar-track {
      background: #F5F0EB;
      border-radius: 4px;
    }
    .fabric-group::-webkit-scrollbar-thumb {
      background: #8E6545;
      border-radius: 4px;
    }
    .fabric-group::-webkit-scrollbar-thumb:hover {
      background: #6d4d35;
    }
  </style>
</head>
<body>
  <!-- Top Bar -->
  <div class="top-bar">
    <div class="top-bar-container">
      <div class="top-bar-left">
        <span><i class="fas fa-phone"></i> 1-800-PEEKABOO</span>
        <span><i class="fas fa-envelope"></i> info@peekabooshades.com</span>
      </div>
      <div class="top-bar-center">
        <a href="#">Free Samples</a>
        <a href="#">Trade</a>
      </div>
      <div class="top-bar-right">
        <a href="#"><i class="far fa-user"></i></a>
        <a href="/cart"><i class="fas fa-shopping-cart"></i></a>
      </div>
    </div>
  </div>

  <!-- Main Header -->
  <header class="main-header">
    <div class="header-container">
      <a href="/" class="logo">
        <img src="/images/peekabooshades_logo.jpeg" alt="Peekaboo Shades" class="logo-img" style="height: 50px; width: auto;">
      </a>

      <nav class="main-nav">
        <ul>
          <li><a href="/shop">Windows Blinds & Shades <i class="fas fa-chevron-down"></i></a></li>
          <li><a href="#">Curtains</a></li>
          <li><a href="#">Look up My Order</a></li>
          <li><a href="#">Bulk Orders/Wholesale</a></li>
          <li><a href="#">Contact Us</a></li>
          <li><a href="#">My Account</a></li>
        </ul>
      </nav>

      <div class="header-right">
        <div class="search-box">
          <input type="text" placeholder="Search">
          <i class="fas fa-search"></i>
        </div>
        <div class="header-icons">
          <a href="#" class="header-icon"><i class="far fa-heart"></i></a>
          <a href="/cart" class="header-icon">
            <i class="fas fa-shopping-cart"></i>
            <span class="cart-count" id="cartCount">0</span>
          </a>
        </div>
      </div>
    </div>
  </header>

  <!-- Product Detail Section -->
  <section class="product-detail-section">
    <div class="product-detail-container">
      <!-- Product Gallery -->
      <div class="product-gallery">
        <div class="gallery-wrapper">
          <div class="thumbnail-column">
            <div class="thumb-item active" onclick="changeImage(this, '/images/products/roller-blinds/gallery-1.jpg')">
              <img src="/images/products/roller-blinds/gallery-1.jpg" alt="Roller Blinds View 1">
            </div>
            <div class="thumb-item" onclick="changeImage(this, '/images/products/roller-blinds/gallery-2.jpg')">
              <img src="/images/products/roller-blinds/gallery-2.jpg" alt="Roller Blinds View 2">
            </div>
            <div class="thumb-item" onclick="changeImage(this, '/images/products/roller-blinds/gallery-3.jpg')">
              <img src="/images/products/roller-blinds/gallery-3.jpg" alt="Roller Blinds View 3">
            </div>
            <div class="thumb-item" onclick="changeImage(this, '/images/products/roller-blinds/gallery-4.jpg')">
              <img src="/images/products/roller-blinds/gallery-4.jpg" alt="Roller Blinds View 4">
            </div>
          </div>
          <div class="main-image">
            <img id="mainProductImage" src="/images/products/roller-blinds/gallery-1.jpg" alt="Roller Blinds Product Image">
          </div>
        </div>
      </div><!-- END product-gallery -->

      <!-- Product Info - RIGHT COLUMN -->
      <div class="product-info">
        <!-- Select Shades Dropdown -->
        <div class="select-shades-dropdown" id="selectShadesDropdown">
          <button class="select-shades-btn" onclick="toggleShadesDropdown()">
            Select your shades
            <i class="fas fa-chevron-down"></i>
          </button>
          <div class="select-shades-menu">
            <a href="/product/affordable-custom-roller-blinds" class="active">Roller Shades</a>
            <a href="/product/affordable-custom-zebra-shades">Zebra Shades</a>
            <a href="/product/energy-efficient-roman-shades">Roman Shades</a>
            <a href="/product/natural-woven-timeless">Honeycomb Shades</a>
            <a href="/product/custom-blackout-drapes">Drapes</a>
          </div>
        </div>

        <h1 class="product-title" id="productTitle">
          Affordable Custom Roller Blinds & shades Blackout & Semi blackout shades | Energy efficient | Custom Blinds & shades
        </h1>

        <p class="product-description" id="productDescription">
          Discover our selection! Roller blinds offer a clean and sleek line that complements any home style. A great value that is sure to work great for your space. Coming in a variety of patterns and colors to help bring out the best in your space.
        </p>

        <div class="product-price-container" id="priceContainer">
          <span class="price-label" id="priceLabel">Base Price:</span>
          <span class="product-price">$<span id="basePrice">40.00</span></span>
        </div>

        <!-- Product Features -->
        <div class="product-features" id="productFeatures" style="display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 20px;">
          <div style="display: flex; align-items: center; gap: 8px; padding: 8px 14px; background: #fff; border: 1px solid #E8E4E0; border-radius: 20px; font-size: 13px; color: #333;">
            <i class="fas fa-check" style="color: #8E6545;"></i>
            <span>Energy Efficient</span>
          </div>
          <div style="display: flex; align-items: center; gap: 8px; padding: 8px 14px; background: #fff; border: 1px solid #E8E4E0; border-radius: 20px; font-size: 13px; color: #333;">
            <i class="fas fa-check" style="color: #8E6545;"></i>
            <span>Custom Sizes</span>
          </div>
          <div style="display: flex; align-items: center; gap: 8px; padding: 8px 14px; background: #fff; border: 1px solid #E8E4E0; border-radius: 20px; font-size: 13px; color: #333;">
            <i class="fas fa-check" style="color: #8E6545;"></i>
            <span>Easy Installation</span>
          </div>
        </div>

        <!-- Trust Badges -->
        <div class="trust-badges" id="trustBadges" style="display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 25px; padding: 15px; background: #F5F0EB; border-radius: 10px;">
          <div style="display: flex; align-items: center; gap: 10px; font-size: 13px; color: #333;">
            <i class="fas fa-truck" style="color: #8E6545; font-size: 18px;"></i>
            <span>Free Shipping</span>
          </div>
          <div style="display: flex; align-items: center; gap: 10px; font-size: 13px; color: #333;">
            <i class="fas fa-shield-alt" style="color: #8E6545; font-size: 18px;"></i>
            <span>5 Year Warranty</span>
          </div>
          <div style="display: flex; align-items: center; gap: 10px; font-size: 13px; color: #333;">
            <i class="fas fa-undo" style="color: #8E6545; font-size: 18px;"></i>
            <span>Easy Returns</span>
          </div>
        </div>

        <!-- Dimensions -->
        <div class="accordion-section" data-name="dimensions">
          <button class="accordion-header" onclick="toggleAccordion(this.parentElement)">
            <div class="accordion-header-left">
              <span>Width X Height <span class="required">*</span></span>
              <span class="accordion-selected" id="dimensionsValue"></span>
            </div>
            <span class="accordion-icon"></span>
          </button>
          <div class="accordion-body">
            <!-- Unit Toggle -->
            <div class="unit-toggle-row" style="margin-bottom: 15px;">
              <span style="font-size: 13px; color: #666; margin-right: 10px;">Unit:</span>
              <div class="unit-toggle" style="display: inline-flex; gap: 5px;">
                <button type="button" class="unit-btn active" data-unit="in" onclick="changeUnit('in')" style="padding: 6px 14px; border: 1px solid #E8E4E0; border-radius: 20px; font-size: 12px; background: #8E6545; color: white; cursor: pointer;">Inches</button>
                <button type="button" class="unit-btn" data-unit="cm" onclick="changeUnit('cm')" style="padding: 6px 14px; border: 1px solid #E8E4E0; border-radius: 20px; font-size: 12px; background: #fff; color: #333; cursor: pointer;">Cm</button>
                <button type="button" class="unit-btn" data-unit="mm" onclick="changeUnit('mm')" style="padding: 6px 14px; border: 1px solid #E8E4E0; border-radius: 20px; font-size: 12px; background: #fff; color: #333; cursor: pointer;">Mm</button>
              </div>
            </div>
            <div class="dimension-row">
              <div class="dimension-group">
                <label>Width</label>
                <div class="dimension-input-wrapper">
                  <input type="number" id="widthInput" value="24" min="12" max="120" step="0.1" onchange="calculatePrice(); updateDimensionsValue()">
                  <span class="unit" id="widthUnit">in</span>
                </div>
              </div>
              <div class="dimension-group">
                <label>Height</label>
                <div class="dimension-input-wrapper">
                  <input type="number" id="heightInput" value="36" min="12" max="120" step="0.1" onchange="calculatePrice(); updateDimensionsValue()">
                  <span class="unit" id="heightUnit">in</span>
                </div>
              </div>
            </div>
            <!-- Conversion Display -->
            <div id="conversionDisplay" style="margin-top: 10px; padding: 10px; background: #F5F0EB; border-radius: 8px; font-size: 12px; color: #666;">
              <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                <span id="convInches"><strong>Inches:</strong> 24 x 36 in</span>
                <span id="convCm"><strong>Cm:</strong> 60.96 x 91.44 cm</span>
                <span id="convMm"><strong>Mm:</strong> 609.6 x 914.4 mm</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Room Label -->
        <div class="accordion-section" data-name="roomLabel">
          <button class="accordion-header" onclick="toggleAccordion(this.parentElement)">
            <div class="accordion-header-left">
              <span>Room Label</span>
              <span class="accordion-selected" id="roomLabelValue"></span>
            </div>
            <span class="accordion-icon"></span>
          </button>
          <div class="accordion-body">
            <select class="config-select" id="roomLabel" onchange="updateSelectedValue('roomLabel')">
              <option value="master-bedroom">Master Bedroom</option>
              <option value="guest-bedroom">Guest Bedroom</option>
              <option value="living-room">Living Room</option>
              <option value="dining-room">Dining Room</option>
              <option value="kitchen">Kitchen</option>
              <option value="bathroom">Bathroom</option>
              <option value="office">Office</option>
            </select>
          </div>
        </div>

        <!-- Shade Style -->
        <div class="accordion-section" data-name="shadeStyle">
          <button class="accordion-header" onclick="toggleAccordion(this.parentElement)">
            <div class="accordion-header-left">
              <span>Shade Style</span>
              <span class="accordion-selected" id="shadeStyleValue"></span>
            </div>
            <span class="accordion-icon"></span>
          </button>
          <div class="accordion-body">
            <span class="swatch-label" style="font-size: 15px; color: #333333; font-weight: 500;">Light Filtering</span>
            <div class="light-filter-buttons" id="lightFilteringSwatches" style="display: flex; gap: 12px; margin-bottom: 24px; flex-wrap: wrap;">
              <button type="button" class="filter-toggle-btn" data-value="transparent" onclick="selectFilterBtn(this)" style="padding: 12px 24px; border: 2px solid #D4D4D4; border-radius: 8px; background: transparent; color: #333333; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">Light Filtering</button>
              <button type="button" class="filter-toggle-btn selected" data-value="blackout" onclick="selectFilterBtn(this)" style="padding: 12px 24px; border: 2px solid #8E6545; border-radius: 8px; background: #8E6545; color: #FFFFFF; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">Blackout</button>
              <button type="button" class="filter-toggle-btn" data-value="semi-blackout" onclick="selectFilterBtn(this)" style="padding: 12px 24px; border: 2px solid #D4D4D4; border-radius: 8px; background: transparent; color: #333333; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">Semi-Blackout</button>
              <button type="button" class="filter-toggle-btn" data-value="super-blackout" onclick="selectFilterBtn(this)" style="padding: 12px 24px; border: 2px solid #D4D4D4; border-radius: 8px; background: transparent; color: #333333; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">Super Blackout</button>
            </div>

            <span class="swatch-label" style="font-size: 15px; color: #333333; font-weight: 500;">Fabric Color</span>

            <!-- Blackout Fabrics - shown by default -->
            <div class="swatch-row fabric-group" id="blackoutFabrics" style="display: flex; flex-wrap: wrap; gap: 10px; max-height: 450px; overflow-y: auto; padding: 10px; border: 1px solid #E8E4E0; border-radius: 8px; scrollbar-width: thin; scrollbar-color: #8E6545 #F5F0EB;">
              <div class="fabric-swatch" data-code="82032A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82032A_blackout.png" alt="82032A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82032A', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82032A_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82032A</span>
              </div>
              <div class="fabric-swatch" data-code="82032B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82032B_blackout.png" alt="82032B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82032B', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82032B_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82032B</span>
              </div>
              <div class="fabric-swatch" data-code="82032D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82032D_blackout.png" alt="82032D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82032D', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82032D_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82032D</span>
              </div>
              <div class="fabric-swatch" data-code="82032E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82032E_blackout.png" alt="82032E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82032E', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82032E_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82032E</span>
              </div>
              <div class="fabric-swatch" data-code="82077A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82077A_blackout.png" alt="82077A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82077A', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82077A_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82077A</span>
              </div>
              <div class="fabric-swatch" data-code="82077B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82077B_blackout.png" alt="82077B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82077B', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82077B_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82077B</span>
              </div>
              <div class="fabric-swatch" data-code="82077C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82077C_blackout.png" alt="82077C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82077C', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82077C_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82077C</span>
              </div>
              <div class="fabric-swatch" data-code="82077D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82077D_blackout.png" alt="82077D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82077D', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82077D_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82077D</span>
              </div>
              <div class="fabric-swatch" data-code="82141E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82141E_blackout.png" alt="82141E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82141E', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82141E_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82141E</span>
              </div>
              <div class="fabric-swatch" data-code="82141F" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82141F_blackout.png" alt="82141F" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82141F', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82141F_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82141F</span>
              </div>
              <div class="fabric-swatch" data-code="82141G" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82141G_blackout.png" alt="82141G" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82141G', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82141G_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82141G</span>
              </div>
              <div class="fabric-swatch" data-code="82141H" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82141H_blackout.png" alt="82141H" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82141H', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82141H_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82141H</span>
              </div>
              <div class="fabric-swatch" data-code="82142A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142A_blackout.png" alt="82142A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82142A', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142A_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82142A</span>
              </div>
              <div class="fabric-swatch" data-code="82142B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142B_blackout.png" alt="82142B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82142B', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142B_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82142B</span>
              </div>
              <div class="fabric-swatch" data-code="82142C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142C_blackout.png" alt="82142C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82142C', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142C_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82142C</span>
              </div>
              <div class="fabric-swatch" data-code="82142D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142D_blackout.png" alt="82142D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82142D', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142D_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82142D</span>
              </div>
              <div class="fabric-swatch" data-code="82142E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142E_blackout.png" alt="82142E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82142E', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82142E_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82142E</span>
              </div>
              <div class="fabric-swatch" data-code="82143A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143A_blackout.png" alt="82143A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82143A', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143A_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82143A</span>
              </div>
              <div class="fabric-swatch" data-code="82143B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143B_blackout.png" alt="82143B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82143B', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143B_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82143B</span>
              </div>
              <div class="fabric-swatch" data-code="82143C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143C_blackout.png" alt="82143C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82143C', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143C_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82143C</span>
              </div>
              <div class="fabric-swatch" data-code="82143D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143D_blackout.png" alt="82143D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82143D', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143D_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82143D</span>
              </div>
              <div class="fabric-swatch" data-code="82143E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143E_blackout.png" alt="82143E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82143E', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82143E_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82143E</span>
              </div>
              <div class="fabric-swatch" data-code="82168A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168A_blackout.png" alt="82168A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82168A', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168A_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82168A</span>
              </div>
              <div class="fabric-swatch" data-code="82168B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168B_blackout.png" alt="82168B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82168B', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168B_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82168B</span>
              </div>
              <div class="fabric-swatch" data-code="82168C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168C_blackout.png" alt="82168C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82168C', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168C_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82168C</span>
              </div>
              <div class="fabric-swatch" data-code="82168D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168D_blackout.png" alt="82168D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82168D', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168D_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82168D</span>
              </div>
              <div class="fabric-swatch" data-code="82168E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168E_blackout.png" alt="82168E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82168E', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82168E_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82168E</span>
              </div>
              <div class="fabric-swatch" data-code="82176A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176A_blackout.png" alt="82176A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82176A', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176A_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82176A</span>
              </div>
              <div class="fabric-swatch" data-code="82176B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176B_blackout.png" alt="82176B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82176B', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176B_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82176B</span>
              </div>
              <div class="fabric-swatch" data-code="82176C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176C_blackout.png" alt="82176C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82176C', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176C_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82176C</span>
              </div>
              <div class="fabric-swatch" data-code="82176D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176D_blackout.png" alt="82176D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82176D', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176D_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82176D</span>
              </div>
              <div class="fabric-swatch" data-code="82176E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176E_blackout.png" alt="82176E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82176E', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176E_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82176E</span>
              </div>
              <div class="fabric-swatch" data-code="82176F" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176F_blackout.png" alt="82176F" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82176F', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176F_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82176F</span>
              </div>
              <div class="fabric-swatch" data-code="82176G" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176G_blackout.png" alt="82176G" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82176G', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82176G_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82176G</span>
              </div>
              <div class="fabric-swatch" data-code="82178A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178A_blackout.png" alt="82178A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82178A', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178A_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82178A</span>
              </div>
              <div class="fabric-swatch" data-code="82178B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178B_blackout.png" alt="82178B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82178B', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178B_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82178B</span>
              </div>
              <div class="fabric-swatch" data-code="82178C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178C_blackout.png" alt="82178C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82178C', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178C_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82178C</span>
              </div>
              <div class="fabric-swatch" data-code="82178D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178D_blackout.png" alt="82178D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82178D', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178D_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82178D</span>
              </div>
              <div class="fabric-swatch" data-code="82178E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178E_blackout.png" alt="82178E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82178E', '/images/RollerBlinds_Zstar_Fabric_Samples/Blackout/82178E_blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82178E</span>
              </div>
            </div>

            <!-- Semi-Blackout Fabrics -->
            <div class="swatch-row fabric-group" id="semiBlackoutFabrics" style="display: none; flex-wrap: wrap; gap: 10px; max-height: 450px; overflow-y: auto; padding: 10px; border: 1px solid #E8E4E0; border-radius: 8px; scrollbar-width: thin; scrollbar-color: #8E6545 #F5F0EB;">
              <div class="fabric-swatch" data-code="82076A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82076A_semi-blackout.png" alt="82076A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82076A', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82076A_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82076A</span>
              </div>
              <div class="fabric-swatch" data-code="82076B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82076B_semi-blackout.png" alt="82076B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82076B', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82076B_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82076B</span>
              </div>
              <div class="fabric-swatch" data-code="82076C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82076C_semi-blackout.png" alt="82076C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82076C', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82076C_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82076C</span>
              </div>
              <div class="fabric-swatch" data-code="82076D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82076D_semi-blackout.png" alt="82076D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82076D', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82076D_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82076D</span>
              </div>
              <div class="fabric-swatch" data-code="82132A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82132A_semi-blackout.png" alt="82132A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82132A', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82132A_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82132A</span>
              </div>
              <div class="fabric-swatch" data-code="82132B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82132B_semi-blackout.png" alt="82132B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82132B', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82132B_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82132B</span>
              </div>
              <div class="fabric-swatch" data-code="82132C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82132C_semi-blackout.png" alt="82132C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82132C', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82132C_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82132C</span>
              </div>
              <div class="fabric-swatch" data-code="82167A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167A_semi-blackout.png" alt="82167A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82167A', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167A_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82167A</span>
              </div>
              <div class="fabric-swatch" data-code="82167B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167B_semi-blackout.png" alt="82167B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82167B', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167B_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82167B</span>
              </div>
              <div class="fabric-swatch" data-code="82167C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167C_semi-blackout.png" alt="82167C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82167C', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167C_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82167C</span>
              </div>
              <div class="fabric-swatch" data-code="82167D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167D_semi-blackout.png" alt="82167D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82167D', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167D_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82167D</span>
              </div>
              <div class="fabric-swatch" data-code="82167E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167E_semi-blackout.png" alt="82167E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82167E', '/images/RollerBlinds_Zstar_Fabric_Samples/Semi_Blackout/82167E_semi-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82167E</span>
              </div>
            </div>

            <!-- Transparent/Light Filtering Fabrics -->
            <div class="swatch-row fabric-group" id="transparentFabrics" style="display: none; flex-wrap: wrap; gap: 10px; max-height: 450px; overflow-y: auto; padding: 10px; border: 1px solid #E8E4E0; border-radius: 8px; scrollbar-width: thin; scrollbar-color: #8E6545 #F5F0EB;">
              <div class="fabric-swatch" data-code="82132D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132D_transparent.png" alt="82132D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82132D', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132D_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82132D</span>
              </div>
              <div class="fabric-swatch" data-code="82132E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132E_transparent.png" alt="82132E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82132E', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132E_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82132E</span>
              </div>
              <div class="fabric-swatch" data-code="82132F" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132F_transparent.png" alt="82132F" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82132F', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132F_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82132F</span>
              </div>
              <div class="fabric-swatch" data-code="82132G" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132G_transparent.png" alt="82132G" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82132G', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132G_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82132G</span>
              </div>
              <div class="fabric-swatch" data-code="82132H" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132H_transparent.png" alt="82132H" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82132H', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82132H_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82132H</span>
              </div>
              <div class="fabric-swatch" data-code="82141A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82141A_transparent.png" alt="82141A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82141A', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82141A_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82141A</span>
              </div>
              <div class="fabric-swatch" data-code="82141B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82141B_transparent.png" alt="82141B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82141B', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82141B_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82141B</span>
              </div>
              <div class="fabric-swatch" data-code="82141C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82141C_transparent.png" alt="82141C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82141C', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82141C_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82141C</span>
              </div>
              <div class="fabric-swatch" data-code="82141D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82141D_transparent.png" alt="82141D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82141D', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82141D_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82141D</span>
              </div>
              <div class="fabric-swatch" data-code="82181A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181A_transparent.png" alt="82181A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82181A', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181A_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82181A</span>
              </div>
              <div class="fabric-swatch" data-code="82181B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181B_transparent.png" alt="82181B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82181B', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181B_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82181B</span>
              </div>
              <div class="fabric-swatch" data-code="82181C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181C_transparent.png" alt="82181C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82181C', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181C_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82181C</span>
              </div>
              <div class="fabric-swatch" data-code="82181D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181D_transparent.png" alt="82181D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82181D', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181D_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82181D</span>
              </div>
              <div class="fabric-swatch" data-code="82181E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181E_transparent.png" alt="82181E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82181E', '/images/RollerBlinds_Zstar_Fabric_Samples/Transparent/82181E_transparent.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82181E</span>
              </div>
            </div>

            <!-- Super Blackout Fabrics -->
            <div class="swatch-row fabric-group" id="superBlackoutFabrics" style="display: none; flex-wrap: wrap; gap: 10px; max-height: 450px; overflow-y: auto; padding: 10px; border: 1px solid #E8E4E0; border-radius: 8px; scrollbar-width: thin; scrollbar-color: #8E6545 #F5F0EB;">
              <div class="fabric-swatch" data-code="82133A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133A_super-blackout.png" alt="82133A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82133A', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133A_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82133A</span>
              </div>
              <div class="fabric-swatch" data-code="82133B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133B_super-blackout.png" alt="82133B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82133B', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133B_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82133B</span>
              </div>
              <div class="fabric-swatch" data-code="82133C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133C_super-blackout.png" alt="82133C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82133C', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133C_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82133C</span>
              </div>
              <div class="fabric-swatch" data-code="82133D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133D_super-blackout.png" alt="82133D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82133D', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133D_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82133D</span>
              </div>
              <div class="fabric-swatch" data-code="82133E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133E_super-blackout.png" alt="82133E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82133E', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82133E_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82133E</span>
              </div>
              <div class="fabric-swatch" data-code="82179A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82179A_super-blackout.png" alt="82179A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82179A', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82179A_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82179A</span>
              </div>
              <div class="fabric-swatch" data-code="82179B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82179B_super-blackout.png" alt="82179B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82179B', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82179B_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82179B</span>
              </div>
              <div class="fabric-swatch" data-code="82179C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82179C_super-blackout.png" alt="82179C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82179C', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82179C_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82179C</span>
              </div>
              <div class="fabric-swatch" data-code="82180A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180A_super-blackout.png" alt="82180A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82180A', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180A_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82180A</span>
              </div>
              <div class="fabric-swatch" data-code="82180B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180B_super-blackout.png" alt="82180B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82180B', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180B_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82180B</span>
              </div>
              <div class="fabric-swatch" data-code="82180C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180C_super-blackout.png" alt="82180C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82180C', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180C_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82180C</span>
              </div>
              <div class="fabric-swatch" data-code="82180D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180D_super-blackout.png" alt="82180D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82180D', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180D_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82180D</span>
              </div>
              <div class="fabric-swatch" data-code="82180E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180E_super-blackout.png" alt="82180E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82180E', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82180E_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82180E</span>
              </div>
              <div class="fabric-swatch" data-code="82183A" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183A_super-blackout.png" alt="82183A" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82183A', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183A_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82183A</span>
              </div>
              <div class="fabric-swatch" data-code="82183B" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183B_super-blackout.png" alt="82183B" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82183B', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183B_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82183B</span>
              </div>
              <div class="fabric-swatch" data-code="82183C" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183C_super-blackout.png" alt="82183C" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82183C', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183C_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82183C</span>
              </div>
              <div class="fabric-swatch" data-code="82183D" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183D_super-blackout.png" alt="82183D" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82183D', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183D_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82183D</span>
              </div>
              <div class="fabric-swatch" data-code="82183E" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
                <div class="swatch-img-container">
                  <img src="/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183E_super-blackout.png" alt="82183E" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;">
                  <button type="button" class="zoom-btn" onclick="openFabricZoom('82183E', '/images/RollerBlinds_Zstar_Fabric_Samples/Super_Blackout/82183E_super-blackout.png', event)" title="Zoom">🔍</button>
                </div>
                <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">82183E</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Mount, Control and Solar Type - Above Hardware Type -->
        <div class="accordion-section" data-name="mountType">
          <button class="accordion-header" onclick="toggleAccordion(this.parentElement)">
            <div class="accordion-header-left">
              <span>Mount, Control and Solar Type</span>
              <span class="accordion-selected" id="mountTypeValue"></span>
            </div>
            <span class="accordion-icon"></span>
          </button>
          <div class="accordion-body">
            <!-- Mount Type -->
            <div class="hardware-group" style="margin-bottom: 24px;">
              <span class="hardware-label" style="font-size: 15px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">Mount Type</span>
              <div class="hardware-swatches" id="mountTypeSwatches" style="display: flex; gap: 12px; flex-wrap: wrap;">
                <div class="hardware-option selected" data-value="inside" data-price="0" onclick="selectHardwareOption(this, 'mountType', event)" style="text-align: center; cursor: pointer;">
                  <div style="width: 100px; height: 80px; border-radius: 8px; overflow: hidden; border: 3px solid #8E6545; background: #ffffff; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; padding: 4px;">
                    <img src="/images/mount-control/inside-mount.svg" alt="Inside Mount" style="width: 100%; height: 100%; object-fit: contain; pointer-events: none;">
                  </div>
                  <span style="font-size: 11px; color: #333; font-weight: 500;">Inside Mount</span>
                </div>
                <div class="hardware-option" data-value="outside" data-price="0" onclick="selectHardwareOption(this, 'mountType', event)" style="text-align: center; cursor: pointer;">
                  <div style="width: 100px; height: 80px; border-radius: 8px; overflow: hidden; border: 2px solid #E5E5E5; background: #ffffff; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; padding: 4px;">
                    <img src="/images/mount-control/outside-mount.svg" alt="Outside Mount" style="width: 100%; height: 100%; object-fit: contain; pointer-events: none;">
                  </div>
                  <span style="font-size: 11px; color: #333; font-weight: 500;">Outside Mount</span>
                </div>
              </div>
            </div>

            <!-- Control Type -->
            <div class="hardware-group" style="margin-bottom: 24px;">
              <span class="hardware-label" style="font-size: 15px; color: #333333; font-weight: 500; display: block; margin-bottom: 8px;">Control Type</span>
              <p id="controlTypePriceNote" style="font-size: 11px; color: #666; margin: 0 0 12px 0; padding: 8px 12px; background: #f5f5f5; border-radius: 6px; display: inline-block;">
                <span style="color: #28a745; font-weight: 600;">Manual: Standard fabric rate</span>
              </p>
              <div class="hardware-swatches" id="controlTypeSwatches" style="display: flex; gap: 12px; flex-wrap: wrap;">
                <div class="hardware-option selected" data-value="manual" data-price="0" onclick="selectControlType(this, event)" style="text-align: center; cursor: pointer;">
                  <div style="width: 100px; height: 80px; border-radius: 8px; overflow: hidden; border: 3px solid #8E6545; background: #ffffff; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; padding: 4px;">
                    <img src="/images/mount-control/manual.svg" alt="Manual" style="width: 100%; height: 100%; object-fit: contain; pointer-events: none;">
                  </div>
                  <span style="font-size: 11px; color: #333; font-weight: 500;">Manual</span>
                </div>
                <div class="hardware-option" data-value="cordless" data-price="0" onclick="selectControlType(this, event)" style="text-align: center; cursor: pointer;">
                  <div style="width: 100px; height: 80px; border-radius: 8px; overflow: hidden; border: 2px solid #E5E5E5; background: #ffffff; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; padding: 4px;">
                    <img src="/images/mount-control/cordless.svg" alt="Cordless" style="width: 100%; height: 100%; object-fit: contain; pointer-events: none;">
                  </div>
                  <span style="font-size: 11px; color: #333; font-weight: 500;">Cordless</span>
                </div>
                <div class="hardware-option" data-value="motorized" data-price="0" onclick="selectControlType(this, event)" style="text-align: center; cursor: pointer;">
                  <div style="width: 100px; height: 80px; border-radius: 8px; overflow: hidden; border: 2px solid #E5E5E5; background: #ffffff; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; padding: 4px;">
                    <img src="/images/mount-control/motorized.svg" alt="Motorized" style="width: 100%; height: 100%; object-fit: contain; pointer-events: none;">
                  </div>
                  <span style="font-size: 11px; color: #333; font-weight: 500;">Motorized</span>
                </div>
              </div>
            </div>

            <!-- Motor Brand (shows only when Motorized is selected) - Dynamically loaded from API -->
            <div class="hardware-group" id="motorBrandGroup" style="margin-bottom: 24px; display: none; padding: 15px; background: #f9f7f4; border-radius: 10px; border-left: 4px solid #8E6545;">
              <span class="hardware-label" style="font-size: 14px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">
                <i class="fas fa-cog" style="color: #8E6545; margin-right: 8px;"></i>Motor Brand
              </span>
              <div class="motor-brand-buttons" id="motorBrandSwatches" style="display: flex; gap: 12px; flex-wrap: wrap;">
                <!-- Motor brands loaded dynamically from /api/products/:slug/options -->
                <span style="color: #666; font-size: 13px;">Loading motor brands...</span>
              </div>
            </div>

            <!-- Chain Location (shows only when Manual is selected) -->
            <div class="hardware-group" id="chainLocationGroup" style="margin-bottom: 24px; display: block; padding: 15px; background: #f9f7f4; border-radius: 10px; border-left: 4px solid #8E6545;">
              <span class="hardware-label" style="font-size: 14px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">
                <i class="fas fa-link" style="color: #8E6545; margin-right: 8px;"></i>Chain Location
              </span>
              <div class="chain-location-buttons" id="chainLocationSwatches" style="display: flex; gap: 15px;">
                <button type="button" class="chain-location-btn selected" data-value="left" onclick="selectChainLocation(this)" style="padding: 14px 35px; border: 2px solid #8E6545; border-radius: 8px; background: #8E6545; color: #FFFFFF; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M15 18l-6-6 6-6"/>
                  </svg>
                  Left
                </button>
                <button type="button" class="chain-location-btn" data-value="right" onclick="selectChainLocation(this)" style="padding: 14px 35px; border: 2px solid #D4D4D4; border-radius: 8px; background: transparent; color: #333; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18l6-6-6-6"/>
                  </svg>
                  Right
                </button>
              </div>
              <p style="font-size: 11px; color: #888; margin-top: 10px; margin-bottom: 0;">
                <i class="fas fa-info-circle" style="margin-right: 5px;"></i>Select which side the chain will be located
              </p>
            </div>

            <!-- Motorized Location (shows only when Motorized is selected) -->
            <div class="hardware-group" id="motorizedLocationGroup" style="margin-bottom: 24px; display: none; padding: 15px; background: #f9f7f4; border-radius: 10px; border-left: 4px solid #8E6545;">
              <span class="hardware-label" style="font-size: 14px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">
                <i class="fas fa-cog" style="color: #8E6545; margin-right: 8px;"></i>Motor Location
              </span>
              <div class="motor-location-buttons" id="motorLocationSwatches" style="display: flex; gap: 15px;">
                <button type="button" class="motor-location-btn selected" data-value="right" onclick="selectMotorLocation(this)" style="padding: 14px 35px; border: 2px solid #8E6545; border-radius: 8px; background: #8E6545; color: #FFFFFF; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18l6-6-6-6"/>
                  </svg>
                  Right
                </button>
                <button type="button" class="motor-location-btn" data-value="left" onclick="selectMotorLocation(this)" style="padding: 14px 35px; border: 2px solid #D4D4D4; border-radius: 8px; background: transparent; color: #333; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px;">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M15 18l-6-6 6-6"/>
                  </svg>
                  Left
                </button>
              </div>
              <p style="font-size: 11px; color: #888; margin-top: 10px; margin-bottom: 0;">
                <i class="fas fa-info-circle" style="margin-right: 5px;"></i>Select which side the motor will be installed
              </p>
            </div>

            <!-- Motor Type (hidden by default - shown only for Motorized) -->
            <div class="hardware-group" id="motorTypeGroup" style="margin-bottom: 24px; display: none;">
              <span class="hardware-label" style="font-size: 15px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">Motor Type</span>
              <div class="motor-type-buttons" id="motorTypeSwatches" style="display: flex; gap: 12px; flex-wrap: wrap;">
                <button type="button" class="motor-btn selected" data-value="battery" onclick="selectMotorType(this)" style="padding: 12px 24px; border: 2px solid #8E6545; border-radius: 8px; background: #8E6545; color: #FFFFFF; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">Battery</button>
                <button type="button" class="motor-btn" data-value="plugin-wire" onclick="selectMotorType(this)" style="padding: 12px 24px; border: 2px solid #D4D4D4; border-radius: 8px; background: transparent; color: #333; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">Plugin Wire</button>
                <button type="button" class="motor-btn" data-value="solar-powered" onclick="selectMotorType(this)" style="padding: 12px 24px; border: 2px solid #D4D4D4; border-radius: 8px; background: transparent; color: #333; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">Solar Powered</button>
              </div>
            </div>

            <!-- Remote Type (hidden by default - shown only for Motorized) -->
            <div class="hardware-group" id="remoteTypeGroup" style="margin-bottom: 24px; display: none;">
              <span class="hardware-label" style="font-size: 15px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">Remote Type</span>
              <div class="remote-type-buttons" id="remoteTypeSwatches" style="display: flex; gap: 12px; flex-wrap: wrap;">
                <!-- Remote types loaded dynamically from /api/products/:slug/options -->
                <span style="color: #666; font-size: 13px;">Loading remote types...</span>
              </div>
            </div>

            <!-- Solar Panel (hidden by default - shown only for Motorized) -->
            <div class="hardware-group" id="solarPanelGroup" style="margin-bottom: 24px; display: none;">
              <span class="hardware-label" style="font-size: 15px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">Solar Panel</span>
              <div class="solar-type-buttons" id="solarTypeSwatches" style="display: flex; gap: 12px;">
                <!-- Solar options loaded dynamically from API -->
                <span style="color: #666; font-size: 13px;">Loading solar options...</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Hardware Type -->
        <div class="accordion-section" data-name="hardwareType">
          <button class="accordion-header" onclick="toggleAccordion(this.parentElement)">
            <div class="accordion-header-left">
              <span>Hardware Type</span>
              <span class="accordion-selected" id="hardwareTypeValue"></span>
            </div>
            <span class="accordion-icon"></span>
          </button>
          <div class="accordion-body">
            <!-- Technical Catalog Reference -->
            <div class="hardware-group" style="margin-bottom: 24px; padding: 15px; background: #F6F1EB; border-radius: 8px;">
              <span style="font-size: 13px; color: #8E6545; font-weight: 600;">For full view of Valance Type</span>
              <p style="font-size: 12px; color: #666; margin-top: 5px;"><a href="/images/hardware/page-4.jpg" target="_blank" style="color: #8E6545; text-decoration: underline;">Valance Options</a> | <a href="/images/hardware/page-5.jpg" target="_blank" style="color: #8E6545; text-decoration: underline;">Bottom Rails</a></p>
            </div>

            <!-- Valance Type - Dynamically loaded from API -->
            <div class="hardware-group" style="margin-bottom: 24px;">
              <span class="hardware-label" style="font-size: 15px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">Valance Type</span>
              <div class="hardware-swatches" id="cassetteSwatches" style="display: flex; gap: 20px; flex-wrap: wrap;">
                <!-- Valance types loaded dynamically from /api/products/:slug/options -->
                <span style="color: #666; font-size: 13px;">Loading valance options...</span>
              </div>
            </div>

            <!-- Bottom Rail - Dynamically loaded from API -->
            <div class="hardware-group" style="margin-bottom: 24px;">
              <span class="hardware-label" style="font-size: 15px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">Bottom Rail</span>
              <div class="hardware-swatches" id="bottomBarSwatches" style="display: flex; gap: 16px; flex-wrap: wrap;">
                <!-- Bottom rail options loaded dynamically from /api/products/:slug/options -->
                <span style="color: #666; font-size: 13px;">Loading bottom rail options...</span>
              </div>
            </div>

            <!-- Roller Type -->
            <div class="hardware-group" style="margin-bottom: 24px;">
              <span class="hardware-label" style="font-size: 15px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">Roller Type</span>
              <div class="hardware-swatches" id="rollerTypeSwatches" style="display: flex; gap: 16px; flex-wrap: wrap;">
                <div class="hardware-option selected" data-value="forward-roll" data-price="0" onclick="selectHardwareOption(this, 'rollerType', event)" style="text-align: center; cursor: pointer; position: relative;">
                  <div style="width: 110px; height: 90px; border-radius: 8px; overflow: hidden; border: 3px solid #8E6545; background: #ffffff; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; padding: 6px; position: relative;">
                    <img src="/images/mount-control/forward-roll.svg" alt="Forward Roll" style="width: 100%; height: 100%; object-fit: contain;">
                    <button onclick="event.stopPropagation(); openZoomModal('/images/mount-control/forward-roll.svg', 'Forward Roll - Fabric hangs close to the window')" style="position: absolute; bottom: 4px; right: 4px; width: 22px; height: 22px; border-radius: 50%; background: rgba(142,101,69,0.9); border: none; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.35-4.35"/><path d="M11 8v6M8 11h6"/></svg>
                    </button>
                  </div>
                  <span style="font-size: 11px; color: #333; font-weight: 600;">Forward Roll</span><br>
                  <span style="font-size: 9px; color: #888;">Close to window</span>
                </div>
                <div class="hardware-option" data-value="reverse-roll" data-price="0" onclick="selectHardwareOption(this, 'rollerType', event)" style="text-align: center; cursor: pointer; position: relative;">
                  <div style="width: 110px; height: 90px; border-radius: 8px; overflow: hidden; border: 2px solid #E5E5E5; background: #ffffff; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; padding: 6px; position: relative;">
                    <img src="/images/mount-control/reverse-roll.svg" alt="Reverse Roll" style="width: 100%; height: 100%; object-fit: contain;">
                    <button onclick="event.stopPropagation(); openZoomModal('/images/mount-control/reverse-roll.svg', 'Reverse Roll - Extra clearance from window')" style="position: absolute; bottom: 4px; right: 4px; width: 22px; height: 22px; border-radius: 50%; background: rgba(142,101,69,0.9); border: none; cursor: pointer; display: flex; align-items: center; justify-content: center;">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2.5"><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.35-4.35"/><path d="M11 8v6M8 11h6"/></svg>
                    </button>
                  </div>
                  <span style="font-size: 11px; color: #333; font-weight: 600;">Reverse Roll</span><br>
                  <span style="font-size: 9px; color: #888;">Extra clearance</span>
                </div>
              </div>
            </div>

            <!-- Side Cover Color -->
            <div class="hardware-group" style="margin-bottom: 24px;">
              <span class="hardware-label" style="font-size: 15px; color: #333333; font-weight: 500; display: block; margin-bottom: 12px;">Side Cover Color</span>
              <div class="hardware-swatches" id="sideCoverSwatches" style="display: flex; gap: 16px; flex-wrap: wrap;">
                <div class="hardware-option selected" data-value="white" data-price="0" onclick="selectHardwareOption(this, 'sideCover', event)" style="text-align: center; cursor: pointer;">
                  <div style="width: 60px; height: 45px; border-radius: 8px; overflow: hidden; border: 3px solid #8E6545; background: #FFFFFF; margin-bottom: 8px;"></div>
                  <span style="font-size: 11px; color: #666;">White</span>
                </div>
                <div class="hardware-option" data-value="gray" data-price="0" onclick="selectHardwareOption(this, 'sideCover', event)" style="text-align: center; cursor: pointer;">
                  <div style="width: 60px; height: 45px; border-radius: 8px; overflow: hidden; border: 2px solid #E5E5E5; background: #808080; margin-bottom: 8px;"></div>
                  <span style="font-size: 11px; color: #666;">Gray</span>
                </div>
                <div class="hardware-option" data-value="black" data-price="0" onclick="selectHardwareOption(this, 'sideCover', event)" style="text-align: center; cursor: pointer;">
                  <div style="width: 60px; height: 45px; border-radius: 8px; overflow: hidden; border: 2px solid #E5E5E5; background: #333333; margin-bottom: 8px;"></div>
                  <span style="font-size: 11px; color: #666;">Black</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Accessories -->
        <div class="accordion-section" data-name="accessories">
          <button class="accordion-header" onclick="toggleAccordion(this.parentElement)">
            <div class="accordion-header-left">
              <span>Accessories</span>
              <span class="accordion-selected" id="accessoriesValue"></span>
            </div>
            <span class="accordion-icon"></span>
          </button>
          <div class="accordion-body">
            <p style="font-size: 13px; color: #666; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#8E6545" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 16v-4m0-4h.01"/>
              </svg>
              Enhance your motorized blinds with these optional accessories
            </p>

            <div class="accessories-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px;">
              <!-- Smart Hub -->
              <div class="accessory-item" style="display: flex; align-items: center; justify-content: space-between; padding: 16px 18px; background: #ffffff; border-radius: 12px; border: 1px solid #e5e5e5; transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
                <div style="display: flex; align-items: center; gap: 14px;">
                  <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #f5ebe0 0%, #e8ddd0 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#8E6545" stroke-width="2">
                      <circle cx="12" cy="12" r="3"/>
                      <path d="M12 2v4m0 12v4M2 12h4m12 0h4"/>
                      <path d="M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/>
                    </svg>
                  </div>
                  <div>
                    <span style="font-size: 14px; font-weight: 600; color: #333; display: block;">Smart Hub</span>
                    <span id="smartHubPrice" style="font-size: 12px; color: #8E6545; font-weight: 600;">$23.50</span>
                  </div>
                </div>
                <div class="accessory-qty" style="display: flex; align-items: center; gap: 8px;">
                  <button onclick="changeAccessoryQty('smartHub', -1)" style="width: 32px; height: 32px; border: 1px solid #8E6545; border-radius: 8px; background: #fff; cursor: pointer; font-size: 18px; color: #8E6545; transition: all 0.2s;">−</button>
                  <input type="number" id="smartHubQty" value="0" min="0" max="10" onchange="calculatePrice()" style="width: 45px; height: 32px; border: 1px solid #8E6545; border-radius: 8px; text-align: center; font-size: 14px; font-weight: 600; color: #8E6545;">
                  <button onclick="changeAccessoryQty('smartHub', 1)" style="width: 32px; height: 32px; border: 1px solid #8E6545; border-radius: 8px; background: #fff; cursor: pointer; font-size: 18px; color: #8E6545; transition: all 0.2s;">+</button>
                </div>
              </div>

              <!-- USB Charger -->
              <div class="accessory-item" style="display: flex; align-items: center; justify-content: space-between; padding: 16px 18px; background: #ffffff; border-radius: 12px; border: 1px solid #e5e5e5; transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
                <div style="display: flex; align-items: center; gap: 14px;">
                  <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #f5ebe0 0%, #e8ddd0 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#8E6545" stroke-width="2">
                      <path d="M7 7h10v10a3 3 0 01-3 3h-4a3 3 0 01-3-3V7z"/>
                      <path d="M9 7V5a1 1 0 011-1h4a1 1 0 011 1v2"/>
                      <path d="M12 11v4"/>
                      <path d="M10 13h4"/>
                    </svg>
                  </div>
                  <div>
                    <span style="font-size: 14px; font-weight: 600; color: #333; display: block;">USB Charger</span>
                    <span id="usbChargerPrice" style="font-size: 12px; color: #8E6545; font-weight: 600;">$5.00</span>
                  </div>
                </div>
                <div class="accessory-qty" style="display: flex; align-items: center; gap: 8px;">
                  <button onclick="changeAccessoryQty('usbCharger', -1)" style="width: 32px; height: 32px; border: 1px solid #8E6545; border-radius: 8px; background: #fff; cursor: pointer; font-size: 18px; color: #8E6545; transition: all 0.2s;">−</button>
                  <input type="number" id="usbChargerQty" value="0" min="0" max="10" onchange="calculatePrice()" style="width: 45px; height: 32px; border: 1px solid #8E6545; border-radius: 8px; text-align: center; font-size: 14px; font-weight: 600; color: #8E6545;">
                  <button onclick="changeAccessoryQty('usbCharger', 1)" style="width: 32px; height: 32px; border: 1px solid #8E6545; border-radius: 8px; background: #fff; cursor: pointer; font-size: 18px; color: #8E6545; transition: all 0.2s;">+</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Quantity & Warranty -->
        <div class="quantity-warranty-row">
          <div class="quantity-group">
            <label class="config-label">Quantity</label>
            <div class="quantity-input">
              <button class="quantity-btn" onclick="changeQuantity(-1)">-</button>
              <input type="number" id="quantityInput" value="1" min="1" max="99" onchange="calculatePrice()">
              <button class="quantity-btn" onclick="changeQuantity(1)">+</button>
            </div>
          </div>
          <div class="warranty-group">
            <label class="config-label">Extended Warranty</label>
            <label class="warranty-checkbox">
              <input type="checkbox" id="extendedWarranty" onchange="calculatePrice()">
              <span class="checkbox-custom"><i class="fas fa-check"></i></span>
              <span class="warranty-text">3 Years Warranty</span>
            </label>
          </div>
        </div>

        <!-- Price Breakdown -->
        <div class="price-breakdown" id="priceBreakdown" style="background: #f8f6f3; border-radius: 12px; padding: 16px; margin-bottom: 16px;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; cursor: pointer;" onclick="togglePriceBreakdown()">
            <span style="font-weight: 600; color: #333; font-size: 14px;">
              <i class="fas fa-receipt" style="margin-right: 8px; color: #8E6545;"></i>Price Breakdown
            </span>
            <i class="fas fa-chevron-down" id="breakdownToggleIcon" style="color: #8E6545; transition: transform 0.3s;"></i>
          </div>
          <div id="breakdownDetails" style="border-top: 1px solid #e0ddd8; padding-top: 12px;">
            <div id="breakdownItems" style="font-size: 13px; color: #555;">
              <!-- Breakdown items will be populated by JavaScript -->
            </div>
            <div style="border-top: 1px dashed #ccc; margin-top: 12px; padding-top: 12px; display: flex; justify-content: space-between; font-weight: 600; color: #333;">
              <span>Subtotal</span>
              <span>$<span id="breakdownSubtotal">0.00</span></span>
            </div>
          </div>
        </div>

        <!-- Price Summary -->
        <div class="price-summary">
          <span class="price-label">Sale Price</span>
          <span class="sale-price">$<span id="totalPrice">75.59</span></span>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button class="btn-add-cart" onclick="addToCart()">
            <i class="fas fa-shopping-cart"></i> Add to Cart
          </button>
          <button class="btn-quote" onclick="openQuoteModal()">
            Request for Quote
          </button>
        </div>

        <button class="shop-pay-btn">
          <span>Buy with</span>
          <img src="https://cdn.shopify.com/shopifycloud/shopify/assets/payment_icons/shopify_pay-957a48d1202dc65a7890b292de764ee886f7e64cea486ae82e291e9dc824c914.svg" alt="Shop Pay" height="18">
        </button>

        <button class="share-btn" onclick="shareProduct()">
          <i class="fas fa-share-alt"></i> Share
        </button>
      </div>
    </div>
  </section>

  <!-- Product Details Section -->
  <section class="product-details-section">
    <div class="product-details-container">
      <div class="product-details-accordion">
        <button class="product-details-header" onclick="toggleProductDetails(this.parentElement)">
          <span>Product Details</span>
          <span class="product-details-icon">+</span>
        </button>
        <div class="product-details-body">
          <div class="details-content">
            <h4>Features</h4>
            <ul>
              <li>Custom-made to your exact measurements</li>
              <li>Premium quality materials</li>
              <li>Easy to install with included hardware</li>
              <li>Child-safe cordless options available</li>
              <li>Energy efficient design</li>
            </ul>
            <h4>Care Instructions</h4>
            <p>Dust regularly with a soft cloth or vacuum with brush attachment. Spot clean with mild soap and water. Do not machine wash or dry clean.</p>
            <h4>Warranty</h4>
            <p>All products come with a standard 1-year warranty. Extended 3-year warranty available at checkout.</p>
          </div>
        </div>
      </div>

      <!-- Product Catalogs Accordion -->
      <div class="product-details-accordion">
        <button class="product-details-header" onclick="toggleProductDetails(this.parentElement)">
          <span>Product Catalogs</span>
          <span class="product-details-icon">+</span>
        </button>
        <div class="product-details-body" style="max-height: none;">
          <div class="details-content catalog-content">

            <!-- Product Features -->
            <div class="catalog-section">
              <h4>Product Features</h4>
              <p>The eco-friendly and durable fabric is made into a variety of shading effects: <strong>transparent, semi-blackout, and full blackout</strong>, with unique design and functions of insulation, dust-proof, shading and light filtering, which is becoming a new favorite in home decoration.</p>
            </div>

            <!-- Available Valance Options -->
            <div class="catalog-section">
              <h4>Available Valance Options</h4>
              <div class="catalog-grid">
                <div class="catalog-item">
                  <strong>Fabric Wrapped SA</strong>
                  <span>Square design with exclusive controller</span>
                </div>
                <div class="catalog-item">
                  <strong>Square V1</strong>
                  <span>Exclusive controller with mount code</span>
                </div>
                <div class="catalog-item">
                  <strong>Square V2</strong>
                  <span>Standard square valance</span>
                </div>
                <div class="catalog-item">
                  <strong>Fabric Wrapped V3</strong>
                  <span>Premium fabric wrapped finish</span>
                </div>
                <div class="catalog-item">
                  <strong>Fabric Inserted S1</strong>
                  <span>Curved white design</span>
                </div>
                <div class="catalog-item">
                  <strong>Curve White S2</strong>
                  <span>Minimalist curved design</span>
                </div>
                <div class="catalog-item">
                  <strong>Fabric Wrapped S3</strong>
                  <span>Burliness finish option</span>
                </div>
              </div>
              <p style="margin-top: 15px;"><strong>Side Cover Colors:</strong> White, Gray, Black</p>
            </div>

            <!-- Bottom Rail Options -->
            <div class="catalog-section">
              <h4>Bottom Rail Options</h4>
              <div class="catalog-grid">
                <div class="catalog-item">
                  <strong>Type A</strong>
                  <span>Streamlined water-drop design</span>
                </div>
                <div class="catalog-item">
                  <strong>Beam Simple Rolling</strong>
                  <span>Clean minimalist beam</span>
                </div>
                <div class="catalog-item">
                  <strong>Fabric Inserted Z1</strong>
                  <span>Day & night blinds compatible</span>
                </div>
                <div class="catalog-item">
                  <strong>End Cap Free Z2</strong>
                  <span>Day & night blinds compatible</span>
                </div>
                <div class="catalog-item">
                  <strong>Fabric Wrapped Z3</strong>
                  <span>Available in White, Brown, Black</span>
                </div>
              </div>
            </div>

            <!-- Configuration Features -->
            <div class="catalog-section">
              <h4>Configuration Features</h4>
              <ul>
                <li><strong>Rectangular:</strong> Standard window shape</li>
                <li><strong>Sloping Cill:</strong> Fabric cut at an angle (Note: blind cannot be fully retracted)</li>
                <li><strong>Multiple Linked:</strong> Single motor operates two or more blinds</li>
                <li><strong>Forward Roll:</strong> Fabric rolls off the back, closest to glazing</li>
                <li><strong>Reverse Roll:</strong> Fabric rolls off the front, extra clearance for window handles</li>
              </ul>
            </div>

            <!-- Light Blocker Options -->
            <div class="catalog-section">
              <h4>Light Blocker Options</h4>
              <div class="catalog-grid">
                <div class="catalog-item">
                  <strong>Aluminium U Shape</strong>
                  <span>White, Gray, Black</span>
                </div>
                <div class="catalog-item">
                  <strong>Adhesive L Shape</strong>
                  <span>White, Beige, Grey, Black</span>
                </div>
              </div>
            </div>

            <!-- Product Type Specifications -->
            <div class="catalog-section">
              <h4>Product Type Specifications</h4>
              <table class="catalog-table">
                <thead>
                  <tr>
                    <th>Type</th>
                    <th>Products</th>
                    <th>Width</th>
                    <th>Light Gap</th>
                    <th>Installation</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Simple</td>
                    <td>Roller Blinds, Shangri-la Blinds</td>
                    <td>0.3~1.5m</td>
                    <td>~3.3cm</td>
                    <td>Most walls</td>
                  </tr>
                  <tr>
                    <td>Curved Plus</td>
                    <td>Roller Blinds, Zebra Blinds, Shangri-la Blinds</td>
                    <td>0.3~1.8m</td>
                    <td>~4.5cm</td>
                    <td>All walls</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- Customizable Size Chart -->
            <div class="catalog-section">
              <h4>Customizable Size Chart</h4>
              <table class="catalog-table">
                <thead>
                  <tr>
                    <th>Valance Type</th>
                    <th>Width (cm)</th>
                    <th>Height (cm)</th>
                    <th>Fabric Deduction</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Simple Rolling (Bead Chain)</td>
                    <td>50-230</td>
                    <td>50-300</td>
                    <td>-2.7cm</td>
                  </tr>
                  <tr>
                    <td>Simple Rolling (Cordless 38 tube)</td>
                    <td>30-230</td>
                    <td>50-250</td>
                    <td>-2.7cm</td>
                  </tr>
                  <tr>
                    <td>Curved Plus (Bead Chain)</td>
                    <td>50-230</td>
                    <td>50-430</td>
                    <td>-2.5cm</td>
                  </tr>
                  <tr>
                    <td>S1 Fabric Inserted</td>
                    <td>50-230</td>
                    <td>50-260</td>
                    <td>-2.5cm</td>
                  </tr>
                  <tr>
                    <td>V2 Square Valance</td>
                    <td>50-230</td>
                    <td>50-320</td>
                    <td>-2.3cm</td>
                  </tr>
                  <tr>
                    <td>S2/S3 Curved Fabric Wrapped</td>
                    <td>50-230</td>
                    <td>50-350</td>
                    <td>-2.8cm</td>
                  </tr>
                  <tr>
                    <td>Z1 Day & Night Valance</td>
                    <td>50-230</td>
                    <td>50-260</td>
                    <td>-2.3cm</td>
                  </tr>
                  <tr>
                    <td>Z2 Square Day & Night</td>
                    <td>50-230</td>
                    <td>50-320</td>
                    <td>-3.3cm</td>
                  </tr>
                  <tr>
                    <td>Z3 Day & Night Valance</td>
                    <td>50-230</td>
                    <td>50-250</td>
                    <td>-2.3cm</td>
                  </tr>
                </tbody>
              </table>
              <p class="catalog-note"><strong>Note:</strong> Max height limits are tested with thicker fabric. Thinner fabric allows for greater height. The minimum width for AM28 motorized is 65cm.</p>
            </div>

          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="faq-section">
    <div class="faq-container">
      <p class="faq-subtitle">We have answers to all your Questions</p>
      <h2 class="faq-title">Frequently Asked Questions (FAQ)</h2>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this.parentElement)">
          <span>How do I measure my window for the right fit?</span>
          <span class="faq-icon">+</span>
        </button>
        <div class="faq-answer">
          <p>Measure the width and height of your window opening in inches. For inside mount, measure the exact opening. For outside mount, add 2-3 inches on each side for optimal coverage and light blockage. We recommend measuring at three points and using the smallest measurement for inside mount.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this.parentElement)">
          <span>Are the blinds easy to install?</span>
          <span class="faq-icon">+</span>
        </button>
        <div class="faq-answer">
          <p>Yes! All our blinds come with easy-to-follow installation instructions and mounting hardware. Most customers complete installation in 15-30 minutes per window.</p>
        </div>
      </div>

      <div class="faq-item">
        <button class="faq-question" onclick="toggleFaq(this.parentElement)">
          <span>What is your return policy?</span>
          <span class="faq-icon">+</span>
        </button>
        <div class="faq-answer">
          <p>We offer a 30-day satisfaction guarantee on all products. If you're not completely satisfied, you can return unused items in original packaging for a full refund.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Explore Trends Section -->
  <section class="trends-section">
    <div class="trends-container">
      <p class="trends-subtitle">You May Also Like</p>
      <h2 class="trends-title">Explore Latest Trends</h2>
      <div class="trends-grid" id="trendsGrid">
        <!-- Products loaded dynamically -->
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="main-footer">
    <div class="footer-container">
      <div class="footer-grid">
        <div class="footer-brand">
          <div class="footer-logo">
            <img src="/images/peekabooshades_logo.jpeg" alt="Peekaboo Shades" class="logo-img" style="height: 40px; width: auto;">
          </div>
          <p class="footer-description">
            Custom Window Blinds & Coverings designed to transform your space. Quality products at affordable prices.
          </p>
          <div class="footer-social">
            <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
            <a href="#" class="social-icon"><i class="fab fa-twitter"></i></a>
          </div>
        </div>

        <div class="footer-column">
          <h4>Products</h4>
          <ul>
            <li><a href="/shop?category=roller-shades">Roller Shades</a></li>
            <li><a href="/shop?category=roman-shades">Roman Shades</a></li>
            <li><a href="/shop?category=natural-woven-shades">Natural Woven</a></li>
            <li><a href="/shop?category=honeycomb-shades">Honeycomb Shades</a></li>
            <li><a href="/shop?category=drapes">Drapes</a></li>
          </ul>
        </div>

        <div class="footer-column">
          <h4>Customer Service</h4>
          <ul>
            <li><a href="#">Track Order</a></li>
            <li><a href="#">Returns</a></li>
            <li><a href="#">Shipping Info</a></li>
            <li><a href="#">FAQs</a></li>
            <li><a href="#">Contact Us</a></li>
          </ul>
        </div>

        <div class="footer-column">
          <h4>Talk To Us</h4>
          <ul>
            <li><a href="#">About Us</a></li>
            <li><a href="#">Careers</a></li>
            <li><a href="#">Press</a></li>
            <li><a href="#">Blog</a></li>
          </ul>
        </div>

        <div class="footer-column">
          <h4>Resources</h4>
          <ul>
            <li><a href="#">Measuring Guide</a></li>
            <li><a href="#">Installation</a></li>
            <li><a href="#">Free Samples</a></li>
            <li><a href="#">Trade Program</a></li>
          </ul>
        </div>
      </div>

      <div class="footer-bottom">
        <p class="footer-copyright">@ 2024 Peekaboo Shades</p>
        <div class="footer-links">
          <a href="#">Privacy Policy</a>
          <a href="#">Terms of Service</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Quote Modal -->
  <div class="modal" id="quoteModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Request a Quote</h3>
        <button class="modal-close" onclick="closeQuoteModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="quoteForm" onsubmit="submitQuote(event)">
          <div class="form-group">
            <label>Name *</label>
            <input type="text" id="quoteName" required>
          </div>
          <div class="form-group">
            <label>Email *</label>
            <input type="email" id="quoteEmail" required>
          </div>
          <div class="form-group">
            <label>Phone</label>
            <input type="tel" id="quotePhone">
          </div>
          <div class="form-group">
            <label>Message</label>
            <textarea id="quoteMessage" placeholder="Tell us about your project..."></textarea>
          </div>
          <button type="submit" class="submit-btn">Submit Quote Request</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Image Zoom Modal -->
  <div class="zoom-modal" id="zoomModal" onclick="closeZoomModal(event)">
    <div class="zoom-modal-content">
      <button class="zoom-close" onclick="closeZoomModal()">&times;</button>
      <img id="zoomImage" src="" alt="Zoomed Image">
      <div class="zoom-caption" id="zoomCaption"></div>
      <div class="zoom-controls">
        <button class="zoom-btn" onclick="zoomIn()" title="Zoom In">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35M11 8v6m-3-3h6"/>
          </svg>
        </button>
        <button class="zoom-btn" onclick="zoomOut()" title="Zoom Out">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/>
            <path d="M21 21l-4.35-4.35M8 11h6"/>
          </svg>
        </button>
        <button class="zoom-btn" onclick="resetZoom()" title="Reset">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
            <path d="M3 3v5h5"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <script src="/js/app.js"></script>

  <!-- Zoom Modal -->
  <div id="zoomModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 10000; justify-content: center; align-items: center;">
    <div style="position: relative; background: white; border-radius: 12px; padding: 20px; max-width: 500px; max-height: 80vh; text-align: center;">
      <button onclick="closeZoomModal()" style="position: absolute; top: 10px; right: 10px; width: 32px; height: 32px; border-radius: 50%; background: #f0f0f0; border: none; cursor: pointer; font-size: 18px; display: flex; align-items: center; justify-content: center;">×</button>
      <img id="zoomModalImage" src="" alt="Zoomed Image" style="max-width: 100%; max-height: 60vh; object-fit: contain; margin-bottom: 15px;">
      <p id="zoomModalCaption" style="font-size: 14px; color: #333; font-weight: 500; margin: 0;"></p>
    </div>
  </div>

  <script>
    // ============================================
    // DYNAMIC THEME LOADING FROM ADMIN PORTAL
    // ============================================

    // Load and apply theme settings from admin portal
    async function loadThemeSettings() {
      try {
        const slug = window.location.pathname.split('/').pop();

        // Load theme and content
        const response = await fetch(`/api/product-page-content/${slug}`);
        const result = await response.json();

        if (result.success) {
          applyTheme(result.data.theme);
          applyContent(result.data.content);
        }

        // Load layout settings from product page sections
        const layoutResponse = await fetch(`/api/product-page-sections/${slug}`);
        const layoutResult = await layoutResponse.json();

        if (layoutResult.success && layoutResult.layout) {
          applyLayout(layoutResult.layout);
        }
        // Apply CSS styles from admin
        if (layoutResult.success && layoutResult.styles) {
          applyCustomStyles(layoutResult.styles);
        }
        // Re-apply element styles AFTER custom styles to ensure they take priority
        if (layoutResult.success && layoutResult.layout && layoutResult.layout.elements) {
          applyElementStyles(layoutResult.layout.elements);
        }
      } catch (error) {
        console.error('Error loading theme:', error);
        // Apply default theme on error
        applyDefaultTheme();
      }
    }

    // Apply custom CSS styles from admin
    function applyCustomStyles(styles) {
      if (!styles || Object.keys(styles).length === 0) return;

      const root = document.documentElement;

      // Page Background
      if (styles.pageBackground) {
        document.body.style.backgroundColor = styles.pageBackground;
        const section = document.querySelector('.product-detail-section');
        if (section) section.style.backgroundColor = styles.pageBackground;
      }

      // Title Styling
      const title = document.querySelector('.product-info h1, .product-title');
      if (title) {
        if (styles.titleFont) title.style.fontFamily = styles.titleFont + ', serif';
        if (styles.titleSize) title.style.fontSize = styles.titleSize;
        if (styles.titleColor) title.style.color = styles.titleColor;
        if (styles.titleWeight) title.style.fontWeight = styles.titleWeight;
      }

      // Body Text Styling
      const productInfo = document.querySelector('.product-info');
      if (productInfo) {
        if (styles.bodyFont) productInfo.style.fontFamily = styles.bodyFont + ', sans-serif';
        if (styles.bodySize) productInfo.style.fontSize = styles.bodySize;
        if (styles.bodyColor) {
          productInfo.querySelectorAll('p, .description').forEach(el => {
            el.style.color = styles.bodyColor;
          });
        }
      }

      // Price Styling
      const price = document.querySelector('.product-price, .price');
      if (price) {
        if (styles.priceSize) price.style.fontSize = styles.priceSize;
        if (styles.priceColor) price.style.color = styles.priceColor;
        if (styles.priceWeight) price.style.fontWeight = styles.priceWeight;
      }

      // Button Styling
      document.querySelectorAll('.add-to-cart-btn, .primary-btn, button[type="submit"]').forEach(btn => {
        if (styles.buttonBackground) btn.style.backgroundColor = styles.buttonBackground;
        if (styles.buttonColor) btn.style.color = styles.buttonColor;
        if (styles.buttonBorderRadius) btn.style.borderRadius = styles.buttonBorderRadius;
        if (styles.buttonPadding) btn.style.padding = styles.buttonPadding;
      });

      // Select Shades Dropdown Styling
      const selectShades = document.querySelector('.select-shades-dropdown, .select-shades-btn');
      if (selectShades) {
        if (styles.selectShadesBackground) selectShades.style.backgroundColor = styles.selectShadesBackground;
        if (styles.selectShadesBorder) selectShades.style.border = styles.selectShadesBorder;
        if (styles.selectShadesBorderRadius) selectShades.style.borderRadius = styles.selectShadesBorderRadius;
      }

      // Option Boxes Styling
      document.querySelectorAll('.option-section, .collapsible-header, .configurator-option').forEach(option => {
        if (styles.optionBackground) option.style.backgroundColor = styles.optionBackground;
        if (styles.optionBorder) option.style.border = styles.optionBorder;
        if (styles.optionBorderRadius) option.style.borderRadius = styles.optionBorderRadius;
        if (styles.optionPadding) option.style.padding = styles.optionPadding;
      });

      // Gallery Styling
      const gallery = document.querySelector('.product-gallery');
      if (gallery) {
        if (styles.galleryWidth) {
          gallery.style.width = styles.galleryWidth;
          // Update grid template
          const container = document.querySelector('.product-detail-container');
          if (container) {
            container.style.gridTemplateColumns = `${styles.galleryWidth} 1fr`;
          }
        }
        if (styles.galleryBorderRadius) {
          gallery.querySelectorAll('img, .main-image').forEach(img => {
            img.style.borderRadius = styles.galleryBorderRadius;
          });
        }
      }

      // Spacing
      if (styles.sectionSpacing) {
        document.querySelectorAll('.product-info > *').forEach(el => {
          el.style.marginBottom = styles.sectionSpacing;
        });
      }

      console.log('Custom styles applied:', styles);
    }

    // Apply layout settings from admin
    function applyLayout(layout) {
      const container = document.querySelector('.product-detail-container');
      if (!container) return;

      // Gallery Position: left or right
      if (layout.galleryPosition === 'right') {
        container.classList.add('layout-gallery-right');
      } else {
        container.classList.remove('layout-gallery-right');
      }

      // Sticky configurator
      const productInfo = document.querySelector('.product-info');
      if (productInfo && layout.stickyConfigurator) {
        productInfo.style.position = 'sticky';
        productInfo.style.top = '20px';
        productInfo.style.height = 'fit-content';
      }

      // Breadcrumbs visibility
      const breadcrumbs = document.querySelector('.breadcrumbs, .breadcrumb');
      if (breadcrumbs && layout.showBreadcrumbs === false) {
        breadcrumbs.style.display = 'none';
      }

      // Configurator style
      const dropdown = document.getElementById('selectShadesDropdown');
      if (dropdown && layout.configuratorStyle === 'expanded') {
        // Auto-expand the configurator
        dropdown.classList.add('expanded');
        const menu = dropdown.querySelector('.select-shades-menu');
        if (menu) menu.style.display = 'block';
      }

      // Apply element positions and alignments
      if (layout.elementPositions) {
        applyElementPositions(layout.elementPositions);
      }

      // Apply element visibility from layout builder (hide deleted/hidden elements)
      if (layout.elements && Array.isArray(layout.elements)) {
        applyElementVisibility(layout.elements);
        // Also apply element column positions (move elements between left/right)
        applyElementColumns(layout.elements);
        // Apply gallery images from layout builder
        applyGalleryImages(layout.elements);
        // Apply element typography and styling
        applyElementStyles(layout.elements);
      }

      console.log('Layout applied:', layout);
    }

    // Apply typography and styling settings to elements
    function applyElementStyles(elements) {
      // Apply price element styling
      const priceElement = elements.find(el => el.id === 'price');
      if (priceElement && priceElement.settings) {
        const settings = priceElement.settings;
        const priceContainerDiv = document.getElementById('priceContainer');
        const priceEl = document.querySelector('.product-price');
        const priceLabelEl = document.getElementById('priceLabel');

        // Apply price label settings
        if (priceLabelEl) {
          // Show/hide label
          if (settings.showPriceLabel === false || settings.priceLabelPosition === 'none') {
            priceLabelEl.style.display = 'none';
          } else {
            priceLabelEl.style.display = '';
            // Label text
            if (settings.priceLabelText) {
              priceLabelEl.textContent = settings.priceLabelText;
            }
            // Label font size
            if (settings.priceLabelFontSize) {
              priceLabelEl.style.fontSize = settings.priceLabelFontSize;
            }
            // Label color
            if (settings.priceLabelColor) {
              priceLabelEl.style.color = settings.priceLabelColor;
            }
          }
        }

        // Apply position (left or above)
        if (priceContainerDiv) {
          if (settings.priceLabelPosition === 'above') {
            priceContainerDiv.classList.add('position-above');
          } else {
            priceContainerDiv.classList.remove('position-above');
          }
        }

        // Apply price typography
        if (priceEl) {
          // Apply font family
          if (settings.priceFontFamily && settings.priceFontFamily !== 'inherit') {
            priceEl.style.fontFamily = settings.priceFontFamily;
          }
          // Apply font size
          if (settings.priceFontSize) {
            priceEl.style.fontSize = settings.priceFontSize;
          }
          // Apply font weight
          if (settings.priceFontWeight) {
            priceEl.style.fontWeight = settings.priceFontWeight;
          }
          // Apply color
          if (settings.priceColor) {
            priceEl.style.color = settings.priceColor;
          }
        }

        console.log('Price styles applied:', settings);
      }

      // Apply product title styling
      const titleElement = elements.find(el => el.id === 'productTitle');
      if (titleElement && titleElement.settings) {
        const settings = titleElement.settings;
        const titleEl = document.getElementById('productTitle');
        const descEl = document.getElementById('productDescription');
        const titleSection = titleEl?.closest('.product-title-section') || titleEl?.parentElement;

        // Apply title text from settings
        if (titleEl && settings.title) {
          titleEl.textContent = settings.title;
        }
        // Apply description text from settings
        if (descEl && settings.description) {
          descEl.textContent = settings.description;
        }

        // Title Typography
        if (titleEl) {
          // Font Family (use titleFontFamily or legacy fontFamily)
          if (settings.titleFontFamily || settings.fontFamily) {
            titleEl.style.setProperty('font-family', settings.titleFontFamily || settings.fontFamily, 'important');
          }
          // Font Size (use titleFontSize or legacy fontSize)
          if (settings.titleFontSize || settings.fontSize) {
            titleEl.style.setProperty('font-size', settings.titleFontSize || settings.fontSize, 'important');
          }
          // Font Weight
          if (settings.titleFontWeight) {
            titleEl.style.setProperty('font-weight', settings.titleFontWeight, 'important');
          }
          // Italic
          titleEl.style.setProperty('font-style', settings.titleItalic ? 'italic' : 'normal', 'important');
          // Underline
          titleEl.style.setProperty('text-decoration', settings.titleUnderline ? 'underline' : 'none', 'important');
          // Uppercase
          titleEl.style.setProperty('text-transform', settings.titleUppercase ? 'uppercase' : 'none', 'important');
          // Title Color (use titleColor or legacy fontColor)
          if (settings.titleColor || settings.fontColor) {
            titleEl.style.setProperty('color', settings.titleColor || settings.fontColor, 'important');
          }
          // Text Alignment
          if (settings.titleAlign) {
            titleEl.style.setProperty('text-align', settings.titleAlign, 'important');
          }
        }

        // Description Typography
        if (descEl) {
          if (settings.descFontFamily) {
            descEl.style.setProperty('font-family', settings.descFontFamily, 'important');
          }
          if (settings.descFontSize) {
            descEl.style.setProperty('font-size', settings.descFontSize, 'important');
          }
          if (settings.descColor) {
            descEl.style.setProperty('color', settings.descColor, 'important');
          }
          // Align description to match title
          if (settings.titleAlign) {
            descEl.style.setProperty('text-align', settings.titleAlign, 'important');
          }
        }

        // Background & Spacing (apply to title section container)
        if (titleSection) {
          // Background Color (respect transparent toggle)
          if (settings.backgroundTransparent) {
            titleSection.style.backgroundColor = 'transparent';
          } else if (settings.backgroundColor) {
            titleSection.style.backgroundColor = settings.backgroundColor;
          }
          // Padding
          if (settings.padding) {
            titleSection.style.padding = settings.padding;
          }
          // Border Radius
          if (settings.borderRadius) {
            titleSection.style.borderRadius = settings.borderRadius;
          }
        }

        console.log('Title styles applied:', settings);
      }

      // Apply addToCart button styling
      const addToCartElement = elements.find(el => el.id === 'addToCart');
      if (addToCartElement && addToCartElement.settings) {
        const settings = addToCartElement.settings;
        const addToCartBtn = document.querySelector('.add-to-cart-btn, #addToCartBtn');

        if (addToCartBtn) {
          if (settings.buttonColor) addToCartBtn.style.backgroundColor = settings.buttonColor;
          if (settings.buttonTextColor) addToCartBtn.style.color = settings.buttonTextColor;
          if (settings.fontFamily) addToCartBtn.style.fontFamily = settings.fontFamily;
          if (settings.fontSize) addToCartBtn.style.fontSize = settings.fontSize;
          if (settings.borderRadius) addToCartBtn.style.borderRadius = settings.borderRadius;
        }
      }
    }

    // Apply gallery images from layout builder settings
    function applyGalleryImages(elements) {
      const galleryElement = elements.find(el => el.id === 'gallery');
      if (!galleryElement || !galleryElement.settings || !galleryElement.settings.images) {
        console.log('No gallery images in layout settings');
        return;
      }

      const images = galleryElement.settings.images.filter(img => img && img.trim() !== '');
      if (images.length === 0) {
        console.log('No valid gallery images found');
        return;
      }

      console.log('Applying gallery images from layout:', images);

      const mainImageEl = document.getElementById('mainProductImage');
      const thumbnailColumn = document.querySelector('.thumbnail-column');

      // Update main image
      if (mainImageEl && images[0]) {
        mainImageEl.src = images[0];
        mainImageEl.alt = 'Product Image';
      }

      // Update thumbnails
      if (thumbnailColumn && images.length > 0) {
        thumbnailColumn.innerHTML = images.slice(0, 5).map((img, i) => `
          <div class="thumb-item ${i === 0 ? 'active' : ''}" onclick="changeImage(this, '${img}')">
            <img src="${img}" alt="Thumbnail ${i + 1}">
          </div>
        `).join('');
      }

      console.log('Gallery images applied successfully');
    }

    // Move elements to left or right column based on layout settings
    function applyElementColumns(elements) {
      const leftColumn = document.querySelector('.product-gallery, .gallery-section');
      const rightColumn = document.querySelector('.product-info, .configurator-section');

      if (!leftColumn || !rightColumn) {
        console.log('Columns not found for element repositioning');
        return;
      }

      // Element ID to DOM selector mapping
      const elementSelectors = {
        selectShades: '#selectShadesDropdown, .select-shades-dropdown',
        productTitle: '#productTitle, .product-info h1',
        price: '#priceContainer, #productPrice, .product-price-container, .product-price',
        features: '.feature-badges, .product-features',
        trustBadges: '#trustBadges, .trust-badges',
        configurator: '.configurator-options, .collapsible-sections',
        addToCart: '#addToCartBtn, .add-to-cart-btn',
        requestQuote: '.request-quote-btn',
        quantity: '.quantity-selector'
      };

      // Find elements that should be in the left column (not gallery)
      elements.forEach(element => {
        if (element.deleted || element.hidden) return;
        if (element.id === 'gallery') return; // Gallery is fixed

        const selector = elementSelectors[element.id];
        if (!selector) return;

        const el = document.querySelector(selector);
        if (!el) return;

        // If element should be in left column but is currently in right
        if (element.column === 'left' && rightColumn.contains(el)) {
          // Move to left column (after gallery)
          leftColumn.appendChild(el);
          el.style.marginTop = '20px';
          console.log(`Moved ${element.id} to left column`);
        }
        // If element should be in right column but is in left
        else if (element.column === 'right' && leftColumn.contains(el)) {
          rightColumn.appendChild(el);
          console.log(`Moved ${element.id} to right column`);
        }
      });
    }

    // Apply element visibility based on layout builder settings
    function applyElementVisibility(elements) {
      console.log('Applying element visibility for:', elements.length, 'elements');

      // Map element IDs to their DOM selectors (multiple selectors for each element)
      const elementSelectors = {
        selectShades: ['#selectShadesDropdown', '.select-shades-dropdown', '.select-shades-btn'],
        productTitle: ['#productTitle', '.product-title-section', '.product-info h1'],
        price: ['#priceContainer', '#productPrice', '.product-price-container', '.product-price', '.price-section', '.price-display'],
        features: ['#productFeatures', '.product-features', '.feature-badges', '.features-list'],
        trustBadges: ['#trustBadges', '.trust-badges', '.trust-section', '.guarantee-badges'],
        configurator: ['.configurator-options', '.option-section', '.shade-configurator', '.collapsible-sections'],
        addToCart: ['#addToCartBtn', '.add-to-cart-btn', '.cart-button'],
        requestQuote: ['#requestQuoteBtn', '.request-quote-btn', '.quote-button'],
        buyWithShopPay: ['.shop-pay-section', '.express-checkout', '.payment-buttons'],
        quantity: ['#quantitySection', '.quantity-selector', '.quantity-input', '.qty-wrapper'],
        productDetails: ['.product-details-section', '.product-details-accordion', '.product-details-container'],
        specifications: ['.product-specifications', '.specs-section', '.product-details-section .product-details-accordion:nth-child(2)'],
        reviews: ['#reviewsSection', '.customer-reviews', '.reviews-section'],
        deliveryInfo: ['#deliverySection', '.delivery-info', '.shipping-info']
      };

      // Create a style element for hiding elements (more reliable than inline styles)
      let hideStyle = document.getElementById('admin-hide-styles');
      if (!hideStyle) {
        hideStyle = document.createElement('style');
        hideStyle.id = 'admin-hide-styles';
        document.head.appendChild(hideStyle);
      }

      let cssRules = '';

      elements.forEach(element => {
        // Check if element is hidden or deleted
        if (element.hidden === true || element.deleted === true) {
          const selectors = elementSelectors[element.id];
          if (selectors && Array.isArray(selectors)) {
            // Add CSS rules to hide elements
            selectors.forEach(selector => {
              cssRules += `${selector} { display: none !important; visibility: hidden !important; }\n`;
            });

            // Also try to hide via JavaScript
            selectors.forEach(selector => {
              try {
                const foundElements = document.querySelectorAll(selector);
                foundElements.forEach(el => {
                  el.style.setProperty('display', 'none', 'important');
                  el.style.setProperty('visibility', 'hidden', 'important');
                  el.setAttribute('data-hidden-by-admin', 'true');
                });
                if (foundElements.length > 0) {
                  console.log(`Hidden ${foundElements.length} element(s) for ${element.id} using: ${selector}`);
                }
              } catch (e) {
                console.warn(`Error hiding ${element.id}:`, e);
              }
            });
          }
        }
      });

      // Apply CSS rules
      hideStyle.textContent = cssRules;
      if (cssRules) {
        console.log('Applied CSS hide rules:', cssRules);
      }
    }

    // Apply element positions (order and alignment)
    function applyElementPositions(positions) {
      const productInfo = document.querySelector('.product-info');
      if (!productInfo) return;

      // Map element keys to their DOM selectors
      const elementMap = {
        selectShades: '#selectShadesDropdown, .select-shades-dropdown',
        productTitle: '#productTitle, .product-title-section, .product-info > h1:first-of-type',
        price: '#priceContainer, #productPrice, .product-price-container, .product-price, .price-display',
        features: '#productFeatures, .feature-badges, .product-features',
        trustBadges: '#trustBadges, .trust-badges, .guarantee-badges',
        configurator: '.configurator-options, .product-options, .collapsible-sections'
      };

      // Apply alignment to each element
      Object.entries(positions).forEach(([key, config]) => {
        const selectors = elementMap[key];
        if (!selectors) return;

        // Try each selector
        selectors.split(', ').forEach(selector => {
          const elements = document.querySelectorAll(selector);
          elements.forEach(el => {
            // Create a wrapper div if needed for proper alignment
            let wrapper = el.parentElement;

            // For Select Shades, we need special handling
            if (key === 'selectShades') {
              // Make sure the element displays as a block for alignment to work
              el.style.display = 'block';
              el.style.width = 'fit-content';

              if (config.align === 'center') {
                el.style.marginLeft = 'auto';
                el.style.marginRight = 'auto';
              } else if (config.align === 'right') {
                el.style.marginLeft = 'auto';
                el.style.marginRight = '0';
                el.style.float = 'right';
              } else {
                el.style.marginLeft = '0';
                el.style.marginRight = 'auto';
                el.style.float = 'none';
              }
              console.log(`Applied ${config.align} alignment to selectShades`);
            } else {
              // Standard alignment for other elements
              if (config.align === 'center') {
                el.style.textAlign = 'center';
                el.style.marginLeft = 'auto';
                el.style.marginRight = 'auto';
              } else if (config.align === 'right') {
                el.style.textAlign = 'right';
                el.style.marginLeft = 'auto';
                el.style.marginRight = '0';
              } else {
                el.style.textAlign = 'left';
                el.style.marginLeft = '0';
                el.style.marginRight = 'auto';
              }
            }

            // Apply order for flexbox/grid ordering
            if (config.order) {
              el.style.order = config.order;
            }
          });
        });
      });

      // Reorder elements within product-info based on order values
      reorderProductInfoElements(positions);
    }

    // Reorder elements within the product-info container
    // Note: This uses CSS order property which only works with flex/grid layouts
    // For now, we'll only apply alignment without reordering to avoid breaking the layout
    function reorderProductInfoElements(positions) {
      // Disabled DOM reordering to prevent layout issues
      // The element order will stay as defined in HTML
      // Only alignment is applied via applyElementPositions()
      console.log('Element positions configured:', positions);
    }

    // Apply theme colors and fonts to CSS variables
    function applyTheme(theme) {
      const root = document.documentElement;

      // Apply colors
      if (theme.colors) {
        root.style.setProperty('--golden-brown', theme.colors.primary || '#8E6545');
        root.style.setProperty('--golden-brown-dark', theme.colors.primaryDark || '#7A5539');
        root.style.setProperty('--dark-brown', theme.colors.primary || '#8E6545');
        root.style.setProperty('--text-dark', theme.colors.textDark || '#333333');
        root.style.setProperty('--text-brown', theme.colors.primary || '#8E6545');
        root.style.setProperty('--text-light', theme.colors.textLight || '#666666');
        root.style.setProperty('--text-muted', theme.colors.textMuted || '#999999');
        root.style.setProperty('--bg-cream', theme.colors.bgCream || '#F8F6F3');
        root.style.setProperty('--bg-light', theme.colors.bgLight || '#FAFAFA');
        root.style.setProperty('--bg-white', theme.colors.bgWhite || '#FFFFFF');
        root.style.setProperty('--border-light', theme.colors.borderLight || '#E8E8E8');
        root.style.setProperty('--border-medium', theme.colors.borderMedium || '#D4D4D4');
        root.style.setProperty('--success-green', theme.colors.success || '#28a745');
        root.style.setProperty('--error-red', theme.colors.error || '#dc3545');

        // Update body background color
        document.body.style.backgroundColor = theme.colors.secondary || '#F6F1EB';
        document.body.style.color = theme.colors.primary || '#8E6545';
      }

      // Apply fonts
      if (theme.fonts) {
        // Load custom font if URL provided
        if (theme.fonts.primary?.url) {
          loadFont(theme.fonts.primary.url);
        }
        if (theme.fonts.primary?.family) {
          document.body.style.fontFamily = `'${theme.fonts.primary.family}', sans-serif`;
        }
        if (theme.fonts.sizes?.base) {
          document.body.style.fontSize = theme.fonts.sizes.base;
        }
      }
    }

    // Load external font
    function loadFont(url) {
      if (!url) return;
      const existingLink = document.querySelector(`link[href="${url}"]`);
      if (!existingLink) {
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = url;
        document.head.appendChild(link);
      }
    }

    // Apply content from admin portal
    function applyContent(content) {
      // Apply header content
      if (content.header) {
        const logoText = document.querySelector('.logo-text');
        if (logoText && content.header.logoText) {
          logoText.innerHTML = content.header.logoText.replace(' ', '<span> ') + '</span>';
        }
      }

      // Apply top bar content
      if (content.topBar) {
        const phoneEl = document.querySelector('.top-bar-left span:first-child');
        const emailEl = document.querySelector('.top-bar-left span:last-child');
        if (phoneEl && content.topBar.phone) {
          phoneEl.innerHTML = `<i class="fas fa-phone-alt"></i> ${content.topBar.phone}`;
        }
        if (emailEl && content.topBar.email) {
          emailEl.innerHTML = `<i class="fas fa-envelope"></i> ${content.topBar.email}`;
        }
      }

      // Apply footer content
      if (content.footer) {
        const copyrightEl = document.querySelector('.footer-copyright');
        if (copyrightEl && content.footer.copyright) {
          copyrightEl.textContent = content.footer.copyright;
        }
      }

      // Apply trust badges
      if (content.trustBadges && content.trustBadges.length > 0) {
        const trustBadgesContainer = document.querySelector('.trust-badges');
        if (trustBadgesContainer) {
          trustBadgesContainer.innerHTML = content.trustBadges.map(badge => `
            <div class="trust-badge">
              <i class="fas ${badge.icon}"></i>
              <span>${badge.title}</span>
            </div>
          `).join('');
        }
      }
    }

    // Apply default theme when API fails
    function applyDefaultTheme() {
      const root = document.documentElement;
      root.style.setProperty('--golden-brown', '#8E6545');
      root.style.setProperty('--golden-brown-dark', '#7A5539');
      root.style.setProperty('--dark-brown', '#8E6545');
    }

    // Zoom Modal Functions
    function openZoomModal(imageSrc, caption) {
      const modal = document.getElementById('zoomModal');
      const image = document.getElementById('zoomModalImage');
      const captionEl = document.getElementById('zoomModalCaption');

      image.src = imageSrc;
      captionEl.textContent = caption;
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    function closeZoomModal() {
      const modal = document.getElementById('zoomModal');
      modal.style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    // Close modal on background click
    document.getElementById('zoomModal')?.addEventListener('click', function(e) {
      if (e.target === this) closeZoomModal();
    });

    // Close modal on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') closeZoomModal();
    });

    // Product data
    let product = null;
    let basePrice = 40.00;

    // Product options loaded from database
    let productOptionsData = null;

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      // Load theme settings first
      loadThemeSettings();

      loadProduct();
      loadProductOptions(); // Load options from database
      loadTrendingProducts();
      updateCartCount();
      updateDimensionsValue();

      // Add click handlers for all fabric swatches
      document.querySelectorAll('.fabric-swatch').forEach(swatch => {
        swatch.addEventListener('click', function(event) {
          selectFabricSwatch(this, event);
        });
      });
    });

    // Store motor brands data globally
    let motorBrandsData = [];

    // Load product options from database and update DOM
    async function loadProductOptions() {
      const slug = window.location.pathname.split('/').pop();

      try {
        const response = await fetch(`/api/products/${slug}/options`);
        const result = await response.json();

        if (result.success && result.options) {
          productOptionsData = result.options;
          console.log('Product options loaded:', productOptionsData);

          // Store motor brands if available
          if (result.motorBrands && result.motorBrands.length > 0) {
            motorBrandsData = result.motorBrands;
            console.log('Motor brands loaded:', motorBrandsData);
          }

          renderDynamicOptions();
        }
      } catch (error) {
        console.error('Error loading product options:', error);
        // Keep default hardcoded options if API fails
      }
    }

    // Render dynamic options based on database data
    function renderDynamicOptions() {
      if (!productOptionsData) return;

      // Update Mount Type options
      if (productOptionsData.mountType) {
        renderOptionSwatches('mountTypeSwatches', productOptionsData.mountType.options, 'mountType', true);
      }

      // Update Control Type options
      if (productOptionsData.controlType) {
        renderOptionSwatches('controlTypeSwatches', productOptionsData.controlType.options, 'controlType', true, true);
      }

      // Update Remote Type options with dynamic prices
      if (productOptionsData.remoteType) {
        renderRemoteTypeOptions('remoteTypeSwatches', productOptionsData.remoteType.options);
      }

      // Update Solar Panel options with dynamic prices
      if (productOptionsData.solarPanel) {
        renderSolarPanelOptions('solarTypeSwatches', productOptionsData.solarPanel.options);
      }

      // Update Motor Brands dynamically
      if (motorBrandsData && motorBrandsData.length > 0) {
        renderMotorBrandsOptions('motorBrandSwatches', motorBrandsData);
      }

      // Update Valance Type (Cassette) options with priceType support
      if (productOptionsData.valanceType) {
        renderPricedOptions('cassetteSwatches', productOptionsData.valanceType.options, 'cassette', 'large');
      }

      // Update Bottom Rail options with priceType support
      if (productOptionsData.bottomRail) {
        renderPricedOptions('bottomBarSwatches', productOptionsData.bottomRail.options, 'bottomBar', 'medium');
      }

      // Update Roller Type options
      if (productOptionsData.rollerType) {
        renderOptionSwatches('rollerTypeSwatches', productOptionsData.rollerType.options, 'rollerType', true, false, 'medium', true);
      }

      // Update Side Cover options
      if (productOptionsData.sideCover) {
        renderSideCoverOptions('sideCoverSwatches', productOptionsData.sideCover.options);
      }

      // Update Accessories
      if (productOptionsData.accessories) {
        renderAccessoriesOptions(productOptionsData.accessories.options);
        // Update accessory prices for calculation
        updateAccessoryPrices();
      }

      // Recalculate price after options are rendered
      calculatePrice();

      // Apply initial Control Type state (Manual is default - hide motorized options)
      applyControlTypeRules();
    }

    // Apply Control Type rules - call on page load and when control type changes
    function applyControlTypeRules() {
      const selectedControlType = document.querySelector('#controlTypeSwatches .hardware-option.selected');
      if (!selectedControlType) return;

      const controlType = selectedControlType.getAttribute('data-value') || 'manual';

      const chainLocationGroup = document.getElementById('chainLocationGroup');
      const motorBrandGroup = document.getElementById('motorBrandGroup');
      const motorizedLocationGroup = document.getElementById('motorizedLocationGroup');
      const motorTypeGroup = document.getElementById('motorTypeGroup');
      const remoteTypeGroup = document.getElementById('remoteTypeGroup');
      const solarPanelGroup = document.getElementById('solarPanelGroup');

      // Helper to show group
      function showGroup(group) {
        if (group) {
          group.style.display = 'block';
          group.style.opacity = '1';
          group.style.pointerEvents = 'auto';
        }
      }

      // Helper to hide group
      function hideGroup(group) {
        if (group) {
          group.style.display = 'none';
          group.style.opacity = '0.5';
          group.style.pointerEvents = 'none';
        }
      }

      if (controlType === 'motorized') {
        // MOTORIZED: Show motor options, hide chain
        showGroup(motorBrandGroup);
        showGroup(motorizedLocationGroup);
        showGroup(motorTypeGroup);
        showGroup(remoteTypeGroup);
        showGroup(solarPanelGroup);
        hideGroup(chainLocationGroup);
      } else if (controlType === 'manual') {
        // MANUAL: Show chain, hide all motor options
        showGroup(chainLocationGroup);
        hideGroup(motorBrandGroup);
        hideGroup(motorizedLocationGroup);
        hideGroup(motorTypeGroup);
        hideGroup(remoteTypeGroup);
        hideGroup(solarPanelGroup);
      } else {
        // CORDLESS: Hide ALL options
        hideGroup(chainLocationGroup);
        hideGroup(motorBrandGroup);
        hideGroup(motorizedLocationGroup);
        hideGroup(motorTypeGroup);
        hideGroup(remoteTypeGroup);
        hideGroup(solarPanelGroup);
      }
    }

    // Render Motor Brands dynamically from API
    function renderMotorBrandsOptions(containerId, brands) {
      const container = document.getElementById(containerId);
      if (!container || !brands || brands.length === 0) return;

      container.innerHTML = brands.map((brand, index) => {
        const isSelected = index === 0 ? 'selected' : '';
        const bgColor = index === 0 ? '#8E6545' : 'transparent';
        const textColor = index === 0 ? '#FFFFFF' : '#333';
        const borderColor = index === 0 ? '#8E6545' : '#D4D4D4';
        const priceDisplay = brand.priceType === 'sqm' ? `from $${brand.price.toFixed(2)}/m²` : `from $${brand.price.toFixed(0)}`;

        return `
          <button type="button" class="motor-brand-btn ${isSelected}" data-value="${brand.value}" data-price="${brand.price}" data-price-type="${brand.priceType || 'flat'}" onclick="selectMotorBrand(this)" style="padding: 12px 24px; border: 2px solid ${borderColor}; border-radius: 8px; background: ${bgColor}; color: ${textColor}; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">
            ${brand.label} (${priceDisplay})
          </button>
        `;
      }).join('');
    }

    // Render Remote Type options dynamically
    function renderRemoteTypeOptions(containerId, options) {
      const container = document.getElementById(containerId);
      if (!container || !options || options.length === 0) return;

      container.innerHTML = options.map((opt, index) => {
        const isSelected = opt.isDefault ? 'selected' : '';
        const bgColor = opt.isDefault ? '#8E6545' : 'transparent';
        const textColor = opt.isDefault ? '#FFFFFF' : '#333';
        const borderColor = opt.isDefault ? '#8E6545' : '#D4D4D4';
        const priceDisplay = opt.price > 0 ? ` (+$${opt.price.toFixed(2)})` : '';

        return `
          <button type="button" class="remote-btn ${isSelected}" data-value="${opt.value}" data-price="${opt.price || 0}" onclick="selectRemoteType(this)" style="padding: 12px 24px; border: 2px solid ${borderColor}; border-radius: 8px; background: ${bgColor}; color: ${textColor}; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">
            ${opt.name}${priceDisplay}
          </button>
        `;
      }).join('');
    }

    // Render Solar Panel options with dynamic prices
    function renderSolarPanelOptions(containerId, options) {
      const container = document.getElementById(containerId);
      if (!container || !options || options.length === 0) return;

      container.innerHTML = options.map(opt => {
        const isSelected = opt.isDefault ? 'selected' : '';
        const bgColor = opt.isDefault ? '#8E6545' : 'transparent';
        const textColor = opt.isDefault ? '#FFFFFF' : '#333';
        const borderColor = opt.isDefault ? '#8E6545' : '#D4D4D4';
        const priceDisplay = opt.price > 0 ? ` (+$${opt.price.toFixed(2)})` : '';

        return `
          <button type="button" class="solar-btn ${isSelected}" data-value="${opt.value}" data-price="${opt.price || 0}" onclick="selectSolarType(this)" style="padding: 12px 32px; border: 2px solid ${borderColor}; border-radius: 8px; background: ${bgColor}; color: ${textColor}; font-size: 14px; font-weight: 500; cursor: pointer; transition: all 0.3s ease;">
            ${opt.name}${priceDisplay}
          </button>
        `;
      }).join('');
    }

    // Render options with priceType support (valance, bottom rail)
    function renderPricedOptions(containerId, options, optionType, size = 'normal') {
      const container = document.getElementById(containerId);
      if (!container || !options || options.length === 0) return;

      let imgWidth = '100px', imgHeight = '80px';
      if (size === 'large') { imgWidth = '150px'; imgHeight = '120px'; }
      if (size === 'medium') { imgWidth = '120px'; imgHeight = '80px'; }

      container.innerHTML = options.map(opt => {
        const isSelected = opt.isDefault ? 'selected' : '';
        const borderStyle = opt.isDefault ? '3px solid #8E6545' : '2px solid #E5E5E5';

        // Handle per-sqm pricing display
        let priceText = '';
        if (opt.price > 0) {
          if (opt.priceType === 'sqm') {
            priceText = `<br>(+$${opt.price.toFixed(2)}/m²)`;
          } else {
            priceText = `<br>(+$${opt.price.toFixed(0)})`;
          }
        }

        return `
          <div class="hardware-option ${isSelected}" data-value="${opt.value}" data-price="${opt.price || 0}" data-price-type="${opt.priceType || 'flat'}" onclick="selectHardwareOption(this, '${optionType}', event)" style="text-align: center; cursor: pointer;">
            <div style="width: ${imgWidth}; height: ${imgHeight}; border-radius: 8px; overflow: visible; border: ${borderStyle}; background: #f5f5f5; margin-bottom: 8px; display: flex; align-items: center; justify-content: center;">
              ${opt.image ? `<img src="${opt.image}" alt="${opt.name}" style="max-width: 100%; max-height: 100%; object-fit: contain;">` : ''}
            </div>
            <span style="font-size: 12px; color: #666;">${opt.name}${priceText}</span>
          </div>
        `;
      }).join('');
    }

    // Generic function to render option swatches
    function renderOptionSwatches(containerId, options, optionType, hasImage = true, isControlType = false, size = 'normal', hasDescription = false) {
      const container = document.getElementById(containerId);
      if (!container || !options || options.length === 0) return;

      // Determine sizes based on type
      let imgWidth = '100px', imgHeight = '80px';
      if (size === 'large') { imgWidth = '150px'; imgHeight = '120px'; }
      if (size === 'medium') { imgWidth = '120px'; imgHeight = '80px'; }

      container.innerHTML = options.map((opt, index) => {
        const isSelected = opt.isDefault ? 'selected' : '';
        const borderStyle = opt.isDefault ? '3px solid #8E6545' : '2px solid #E5E5E5';
        const priceText = opt.price > 0 ? ` (+$${opt.price.toFixed(0)})` : '';

        const clickHandler = isControlType
          ? `onclick="selectControlType(this, event)"`
          : `onclick="selectHardwareOption(this, '${optionType}', event)"`;

        return `
          <div class="hardware-option ${isSelected}" data-value="${opt.value}" data-price="${opt.price}" ${clickHandler} style="text-align: center; cursor: pointer;">
            ${hasImage && opt.image ? `
              <div style="width: ${imgWidth}; height: ${imgHeight}; border-radius: 8px; overflow: hidden; border: ${borderStyle}; background: #ffffff; margin-bottom: 6px; display: flex; align-items: center; justify-content: center; padding: 4px;">
                <img src="${opt.image}" alt="${opt.name}" style="width: 100%; height: 100%; object-fit: contain; pointer-events: none;">
              </div>
            ` : ''}
            <span style="font-size: 11px; color: #333; font-weight: 500;">${opt.name}${priceText}</span>
            ${hasDescription && opt.description ? `<br><span style="font-size: 9px; color: #888;">${opt.description}</span>` : ''}
          </div>
        `;
      }).join('');
    }

    // Render side cover color options
    function renderSideCoverOptions(containerId, options) {
      const container = document.getElementById(containerId);
      if (!container || !options || options.length === 0) return;

      container.innerHTML = options.map(opt => {
        const isSelected = opt.isDefault ? 'selected' : '';
        const borderStyle = opt.isDefault ? '3px solid #8E6545' : '2px solid #E5E5E5';

        return `
          <div class="hardware-option ${isSelected}" data-value="${opt.value}" data-price="${opt.price}" onclick="selectHardwareOption(this, 'sideCover', event)" style="text-align: center; cursor: pointer;">
            <div style="width: 60px; height: 45px; border-radius: 8px; overflow: hidden; border: ${borderStyle}; background: ${opt.color || '#FFFFFF'}; margin-bottom: 8px;"></div>
            <span style="font-size: 11px; color: #666;">${opt.name}</span>
          </div>
        `;
      }).join('');
    }

    // Render accessories options
    function renderAccessoriesOptions(options) {
      const grid = document.querySelector('.accessories-grid');
      if (!grid || !options || options.length === 0) return;

      grid.innerHTML = options.map(opt => {
        const optionId = opt.value.replace(/[^a-zA-Z0-9]/g, '');
        return `
          <div class="accessory-item" style="display: flex; align-items: center; justify-content: space-between; padding: 16px 18px; background: #ffffff; border-radius: 12px; border: 1px solid #e5e5e5; transition: all 0.2s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.04);">
            <div style="display: flex; align-items: center; gap: 14px;">
              <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #f5ebe0 0%, #e8ddd0 100%); border-radius: 10px; display: flex; align-items: center; justify-content: center;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#8E6545" stroke-width="2">
                  <circle cx="12" cy="12" r="3"/>
                  <path d="M12 2v4m0 12v4M2 12h4m12 0h4"/>
                </svg>
              </div>
              <div>
                <span style="font-size: 14px; font-weight: 600; color: #333; display: block;">${opt.name}</span>
                <span style="font-size: 12px; color: #8E6545; font-weight: 600;">$${opt.price.toFixed(2)}</span>
              </div>
            </div>
            <div class="accessory-qty" style="display: flex; align-items: center; gap: 8px;">
              <button onclick="changeAccessoryQty('${optionId}', -1)" style="width: 32px; height: 32px; border: 1px solid #8E6545; border-radius: 8px; background: #fff; cursor: pointer; font-size: 18px; color: #8E6545; transition: all 0.2s;">−</button>
              <input type="number" id="${optionId}Qty" value="0" min="0" max="${opt.maxQty || 10}" onchange="calculatePrice()" style="width: 45px; height: 32px; border: 1px solid #8E6545; border-radius: 8px; text-align: center; font-size: 14px; font-weight: 600; color: #8E6545;">
              <button onclick="changeAccessoryQty('${optionId}', 1)" style="width: 32px; height: 32px; border: 1px solid #8E6545; border-radius: 8px; background: #fff; cursor: pointer; font-size: 18px; color: #8E6545; transition: all 0.2s;">+</button>
            </div>
          </div>
        `;
      }).join('');
    }

    // Load product
    async function loadProduct() {
      const slug = window.location.pathname.split('/').pop();

      try {
        const response = await fetch(`/api/products/${slug}`);
        const result = await response.json();

        if (result.success) {
          product = result.data;

          // Check if product is available
          if (!product.is_active || product.is_discontinued) {
            showProductUnavailable(product);
            return;
          }

          displayProduct(product);

          // TICKET 015: Track product view
          if (typeof trackEvent === 'function') {
            trackEvent('product_view', {
              productId: product.id,
              productName: product.name,
              product_id: product.id,
              product_name: product.name
            });
          }

          // Check stock status
          if (product.stock_status === 'out_of_stock') {
            showOutOfStock();
          }
        } else {
          showProductUnavailable(null);
        }
      } catch (error) {
        console.error('Error loading product:', error);
        showProductUnavailable(null);
      }

      calculatePrice();
    }

    // Show product unavailable message
    function showProductUnavailable(product) {
      const mainContent = document.querySelector('.product-page-container');
      if (mainContent) {
        mainContent.innerHTML = `
          <div style="text-align: center; padding: 100px 20px;">
            <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" fill="none" viewBox="0 0 24 24" stroke="#999" style="margin-bottom: 20px;">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636"/>
            </svg>
            <h1 style="font-size: 28px; color: #333; margin-bottom: 15px;">Product Unavailable</h1>
            <p style="font-size: 16px; color: #666; margin-bottom: 30px;">
              ${product ? 'This product has been discontinued or is no longer available.' : 'The product you are looking for could not be found.'}
            </p>
            <a href="/shop" style="display: inline-block; padding: 12px 30px; background: #8E6545; color: white; text-decoration: none; border-radius: 6px; font-weight: 600;">
              Browse Our Products
            </a>
          </div>
        `;
      }
    }

    // Show out of stock message and disable Add to Cart
    function showOutOfStock() {
      const addToCartBtn = document.querySelector('.btn-add-cart');
      if (addToCartBtn) {
        addToCartBtn.disabled = true;
        addToCartBtn.style.opacity = '0.5';
        addToCartBtn.style.cursor = 'not-allowed';
        addToCartBtn.innerHTML = '<i class="fas fa-times-circle"></i> Out of Stock';
        addToCartBtn.onclick = function(e) {
          e.preventDefault();
          showToast('This product is currently out of stock', 'error');
        };
      }

      // Add out of stock banner
      const priceSection = document.querySelector('.price-section') || document.querySelector('.total-price');
      if (priceSection) {
        const banner = document.createElement('div');
        banner.style.cssText = 'background: #fff3cd; border: 1px solid #ffc107; color: #856404; padding: 12px 16px; border-radius: 6px; margin-top: 15px; text-align: center; font-weight: 500;';
        banner.innerHTML = '<i class="fas fa-exclamation-triangle"></i> This product is currently out of stock. Please check back later.';
        priceSection.parentNode.insertBefore(banner, priceSection.nextSibling);
      }
    }

    // Display product
    function displayProduct(product) {
      document.getElementById('productTitle').textContent = product.name;
      document.getElementById('productDescription').textContent = product.description || '';
      document.getElementById('basePrice').textContent = product.base_price.toFixed(2);
      basePrice = product.base_price;

      // Update product images if available
      if (product.image_url || (product.gallery_images && product.gallery_images.length > 0)) {
        updateProductGallery(product);
      }
    }

    // Update product gallery with images from database
    function updateProductGallery(product) {
      const mainImageEl = document.getElementById('mainProductImage');
      const thumbnailColumn = document.querySelector('.thumbnail-column');

      // Collect all available images
      const images = [];
      if (product.image_url) {
        images.push(product.image_url);
      }
      if (product.gallery_images && Array.isArray(product.gallery_images)) {
        images.push(...product.gallery_images);
      }

      if (images.length === 0) return;

      // Update main image
      mainImageEl.src = images[0];
      mainImageEl.alt = product.name;

      // Update thumbnails
      if (thumbnailColumn && images.length > 0) {
        thumbnailColumn.innerHTML = images.slice(0, 4).map((img, i) => `
          <div class="thumb-item ${i === 0 ? 'active' : ''}" onclick="changeImage(this, '${img}')">
            <img src="${img}" alt="Thumbnail ${i + 1}">
          </div>
        `).join('');
      }
    }

    // Change main image
    function changeImage(thumb, imageUrl) {
      document.querySelectorAll('.thumb-item').forEach(t => t.classList.remove('active'));
      thumb.classList.add('active');
      document.getElementById('mainProductImage').src = imageUrl;
    }

    // Toggle accordion
    function toggleAccordion(accordion) {
      const wasOpen = accordion.classList.contains('open');
      document.querySelectorAll('.accordion-section').forEach(a => a.classList.remove('open'));
      if (!wasOpen) {
        accordion.classList.add('open');
      }
    }

    // Update selected value display
    function updateSelectedValue(name) {
      const select = document.getElementById(name);
      const valueSpan = document.getElementById(name + 'Value');
      if (select && valueSpan) {
        valueSpan.textContent = select.options[select.selectedIndex].text;
      }
    }

    // Current unit state
    let currentUnit = 'in';

    // Conversion factors (to inches)
    const conversionFactors = {
      'in': 1,
      'cm': 2.54,
      'mm': 25.4
    };

    // Change unit
    function changeUnit(newUnit) {
      const widthInput = document.getElementById('widthInput');
      const heightInput = document.getElementById('heightInput');

      // Get current values in inches
      const widthInInches = parseFloat(widthInput.value) / conversionFactors[currentUnit] * conversionFactors['in'];
      const heightInInches = parseFloat(heightInput.value) / conversionFactors[currentUnit] * conversionFactors['in'];

      // Convert to new unit
      const newWidth = widthInInches * conversionFactors[newUnit];
      const newHeight = heightInInches * conversionFactors[newUnit];

      // Update inputs
      widthInput.value = newUnit === 'in' ? newWidth.toFixed(1) : newWidth.toFixed(2);
      heightInput.value = newUnit === 'in' ? newHeight.toFixed(1) : newHeight.toFixed(2);

      // Update unit labels
      document.getElementById('widthUnit').textContent = newUnit;
      document.getElementById('heightUnit').textContent = newUnit;

      // Update button styles
      document.querySelectorAll('.unit-btn').forEach(btn => {
        if (btn.dataset.unit === newUnit) {
          btn.style.background = '#8E6545';
          btn.style.color = 'white';
          btn.classList.add('active');
        } else {
          btn.style.background = '#fff';
          btn.style.color = '#333';
          btn.classList.remove('active');
        }
      });

      currentUnit = newUnit;
      updateDimensionsValue();
      updateConversionDisplay();
    }

    // Update conversion display
    function updateConversionDisplay() {
      const widthInput = document.getElementById('widthInput');
      const heightInput = document.getElementById('heightInput');

      // Get current values in inches
      const widthInInches = parseFloat(widthInput.value) / conversionFactors[currentUnit] * conversionFactors['in'];
      const heightInInches = parseFloat(heightInput.value) / conversionFactors[currentUnit] * conversionFactors['in'];

      // Calculate all conversions
      const widthCm = widthInInches * 2.54;
      const heightCm = heightInInches * 2.54;
      const widthMm = widthInInches * 25.4;
      const heightMm = heightInInches * 25.4;

      // Update display
      document.getElementById('convInches').innerHTML = `<strong>Inches:</strong> ${widthInInches.toFixed(1)} x ${heightInInches.toFixed(1)} in`;
      document.getElementById('convCm').innerHTML = `<strong>Cm:</strong> ${widthCm.toFixed(2)} x ${heightCm.toFixed(2)} cm`;
      document.getElementById('convMm').innerHTML = `<strong>Mm:</strong> ${widthMm.toFixed(1)} x ${heightMm.toFixed(1)} mm`;
    }

    // Update dimensions value display
    function updateDimensionsValue() {
      const width = document.getElementById('widthInput').value;
      const height = document.getElementById('heightInput').value;
      const unit = currentUnit;
      const valueSpan = document.getElementById('dimensionsValue');
      if (valueSpan) {
        valueSpan.textContent = width + ' x ' + height + ' ' + unit;
      }
      updateConversionDisplay();
    }

    // Select swatch
    function selectSwatch(swatch, type) {
      const container = swatch.parentElement;
      container.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('selected'));
      swatch.classList.add('selected');
      calculatePrice();
    }

    // Select filter button (Light Filtering toggle)
    function selectFilterBtn(btn) {
      const container = btn.parentElement;
      container.querySelectorAll('.filter-toggle-btn').forEach(b => {
        b.style.background = 'transparent';
        b.style.color = '#333333';
        b.style.borderColor = '#D4D4D4';
        b.classList.remove('selected');
      });
      btn.style.background = '#8E6545';
      btn.style.color = '#FFFFFF';
      btn.style.borderColor = '#8E6545';
      btn.classList.add('selected');

      // Show/hide fabric swatches based on selection
      const filterValue = btn.dataset.value;
      document.getElementById('blackoutFabrics').style.display = 'none';
      document.getElementById('semiBlackoutFabrics').style.display = 'none';
      document.getElementById('transparentFabrics').style.display = 'none';
      const superBlackoutEl = document.getElementById('superBlackoutFabrics');
      if (superBlackoutEl) superBlackoutEl.style.display = 'none';

      if (filterValue === 'blackout') {
        document.getElementById('blackoutFabrics').style.display = 'flex';
        // Select first swatch in blackout
        const firstSwatch = document.querySelector('#blackoutFabrics .fabric-swatch');
        if (firstSwatch) selectFabricSwatch(firstSwatch);
      } else if (filterValue === 'semi-blackout') {
        document.getElementById('semiBlackoutFabrics').style.display = 'flex';
        // Select first swatch in semi-blackout
        const firstSwatch = document.querySelector('#semiBlackoutFabrics .fabric-swatch');
        if (firstSwatch) selectFabricSwatch(firstSwatch);
      } else if (filterValue === 'transparent') {
        document.getElementById('transparentFabrics').style.display = 'flex';
        // Select first swatch in transparent
        const firstSwatch = document.querySelector('#transparentFabrics .fabric-swatch');
        if (firstSwatch) selectFabricSwatch(firstSwatch);
      } else if (filterValue === 'super-blackout') {
        if (superBlackoutEl) superBlackoutEl.style.display = 'flex';
        // Select first swatch in super-blackout
        const firstSwatch = document.querySelector('#superBlackoutFabrics .fabric-swatch');
        if (firstSwatch) selectFabricSwatch(firstSwatch);
      }

      calculatePrice();
    }

    // Select fabric swatch
    function selectFabricSwatch(swatch, event) {
      if (event) event.preventDefault();
      const scrollPos = window.scrollY;
      // Remove selection from all fabric swatches across all groups
      document.querySelectorAll('.fabric-group .fabric-swatch').forEach(s => {
        s.classList.remove('selected');
        const img = s.querySelector('img');
        if (img) img.style.border = '2px solid transparent';
      });
      swatch.classList.add('selected');
      const img = swatch.querySelector('img');
      if (img) img.style.border = '3px solid #8E6545';
      calculatePrice();
      window.scrollTo(0, scrollPos);
    }

    // Select hardware swatch
    function selectHardware(swatch, type) {
      const container = swatch.parentElement;
      container.querySelectorAll('.hardware-swatch').forEach(s => s.classList.remove('selected'));
      swatch.classList.add('selected');
    }

    // Select hardware option (new design with images)
    function selectHardwareOption(option, type, event) {
      if (event) event.preventDefault();
      const scrollPos = window.scrollY;
      const container = option.parentElement;
      container.querySelectorAll('.hardware-option').forEach(opt => {
        opt.classList.remove('selected');
        opt.querySelector('div').style.border = '2px solid #E5E5E5';
      });
      option.classList.add('selected');
      option.querySelector('div').style.border = '3px solid #8E6545';
      calculatePrice();
      window.scrollTo(0, scrollPos);
    }

    // Select chain side button
    function selectChainSide(btn) {
      const container = btn.parentElement;
      container.querySelectorAll('.chain-side-btn').forEach(b => {
        b.style.background = 'transparent';
        b.style.color = '#333333';
        b.style.borderColor = '#D4D4D4';
        b.classList.remove('selected');
      });
      btn.style.background = '#8E6545';
      btn.style.color = '#FFFFFF';
      btn.style.borderColor = '#8E6545';
      btn.classList.add('selected');
    }

    // Select control type (Manual/Cordless/Motorized)
    function selectControlType(option, event) {
      if (event) event.preventDefault();
      const scrollPos = window.scrollY;
      const container = option.parentElement;
      container.querySelectorAll('.hardware-option').forEach(opt => {
        opt.classList.remove('selected');
        opt.querySelector('div').style.border = '2px solid #E5E5E5';
      });
      option.classList.add('selected');
      option.querySelector('div').style.border = '3px solid #8E6545';

      // CONTROL TYPE → OPTIONS ENGINE
      // Strict rules for showing/hiding options based on control type:
      // Manual: Enable Chain Location, Hide Motor Type/Brand/Remote/Solar
      // Cordless: Hide ALL (Chain, Motor, Remote, Solar)
      // Motorized: Enable Motor Type/Brand/Remote/Solar, Hide Chain

      const chainLocationGroup = document.getElementById('chainLocationGroup');
      const motorBrandGroup = document.getElementById('motorBrandGroup');
      const motorizedLocationGroup = document.getElementById('motorizedLocationGroup');
      const motorTypeGroup = document.getElementById('motorTypeGroup');
      const remoteTypeGroup = document.getElementById('remoteTypeGroup');
      const solarPanelGroup = document.getElementById('solarPanelGroup');
      const priceNote = document.getElementById('controlTypePriceNote');
      const selectedValue = option.getAttribute('data-value');

      // Helper function to show a group with animation
      function showGroup(group) {
        if (group) {
          group.style.display = 'block';
          group.style.animation = 'slideDown 0.3s ease';
          group.style.opacity = '1';
          group.style.pointerEvents = 'auto';
        }
      }

      // Helper function to hide and disable a group
      function hideGroup(group) {
        if (group) {
          group.style.display = 'none';
          group.style.opacity = '0.5';
          group.style.pointerEvents = 'none';
        }
      }

      // Update price note based on control type
      if (priceNote) {
        if (selectedValue === 'motorized') {
          priceNote.innerHTML = '<span style="color: #1565c0; font-weight: 600;">Motorized: Standard fabric rate</span> + Motor Brand cost';
        } else if (selectedValue === 'cordless') {
          priceNote.innerHTML = '<span style="color: #e65100; font-weight: 600;">Cordless: +$3.25/m² fabric</span> (includes cordless spring)';
        } else {
          priceNote.innerHTML = '<span style="color: #28a745; font-weight: 600;">Manual: Standard fabric rate</span>';
        }
      }

      if (selectedValue === 'motorized') {
        // MOTORIZED: Show motor options, hide chain
        showGroup(motorBrandGroup);
        showGroup(motorizedLocationGroup);
        showGroup(motorTypeGroup);
        showGroup(remoteTypeGroup);
        showGroup(solarPanelGroup);
        hideGroup(chainLocationGroup);

        // Auto-select accessories for motorized
        const smartHubInput = document.getElementById('smartHubQty');
        const usbChargerInput = document.getElementById('usbChargerQty');
        if (smartHubInput && parseInt(smartHubInput.value) === 0) {
          smartHubInput.value = 1;
        }
        if (usbChargerInput && parseInt(usbChargerInput.value) === 0) {
          usbChargerInput.value = 1;
        }
      } else if (selectedValue === 'manual') {
        // MANUAL: Show chain, hide all motor options
        showGroup(chainLocationGroup);
        hideGroup(motorBrandGroup);
        hideGroup(motorizedLocationGroup);
        hideGroup(motorTypeGroup);
        hideGroup(remoteTypeGroup);
        hideGroup(solarPanelGroup);
      } else {
        // CORDLESS: Hide ALL options (chain, motor, remote, solar)
        hideGroup(chainLocationGroup);
        hideGroup(motorBrandGroup);
        hideGroup(motorizedLocationGroup);
        hideGroup(motorTypeGroup);
        hideGroup(remoteTypeGroup);
        hideGroup(solarPanelGroup);
      }

      calculatePrice();
      window.scrollTo(0, scrollPos);
    }

    // Select chain location (Left/Right)
    function selectChainLocation(btn) {
      const container = btn.parentElement;
      container.querySelectorAll('.chain-location-btn').forEach(b => {
        b.style.background = 'transparent';
        b.style.color = '#333';
        b.style.border = '2px solid #D4D4D4';
        b.classList.remove('selected');
      });
      btn.style.background = '#8E6545';
      btn.style.color = '#FFFFFF';
      btn.style.border = '2px solid #8E6545';
      btn.classList.add('selected');
    }

    // Select motor location (Right/Left)
    function selectMotorLocation(btn) {
      const container = btn.parentElement;
      container.querySelectorAll('.motor-location-btn').forEach(b => {
        b.style.background = 'transparent';
        b.style.color = '#333';
        b.style.border = '2px solid #D4D4D4';
        b.classList.remove('selected');
      });
      btn.style.background = '#8E6545';
      btn.style.color = '#FFFFFF';
      btn.style.border = '2px solid #8E6545';
      btn.classList.add('selected');
    }

    // Select motor type button
    function selectMotorType(btn) {
      const container = btn.parentElement;
      container.querySelectorAll('.motor-btn').forEach(b => {
        b.style.background = 'transparent';
        b.style.color = '#333333';
        b.style.borderColor = '#D4D4D4';
        b.classList.remove('selected');
      });
      btn.style.background = '#8E6545';
      btn.style.color = '#FFFFFF';
      btn.style.borderColor = '#8E6545';
      btn.classList.add('selected');
      calculatePrice();
    }

    // Select motor brand button (AOK/Dooya)
    function selectMotorBrand(btn) {
      const container = btn.parentElement;
      container.querySelectorAll('.motor-brand-btn').forEach(b => {
        b.style.background = 'transparent';
        b.style.color = '#333333';
        b.style.borderColor = '#D4D4D4';
        b.classList.remove('selected');
      });
      btn.style.background = '#8E6545';
      btn.style.color = '#FFFFFF';
      btn.style.borderColor = '#8E6545';
      btn.classList.add('selected');
      calculatePrice();
    }

    // Select remote type button
    function selectRemoteType(btn) {
      const container = btn.parentElement;
      container.querySelectorAll('.remote-btn').forEach(b => {
        b.style.background = 'transparent';
        b.style.color = '#333333';
        b.style.borderColor = '#D4D4D4';
        b.classList.remove('selected');
      });
      btn.style.background = '#8E6545';
      btn.style.color = '#FFFFFF';
      btn.style.borderColor = '#8E6545';
      btn.classList.add('selected');
    }

    // Select solar type button
    function selectSolarType(btn) {
      const container = btn.parentElement;
      container.querySelectorAll('.solar-btn').forEach(b => {
        b.style.background = 'transparent';
        b.style.color = '#333333';
        b.style.borderColor = '#D4D4D4';
        b.classList.remove('selected');
      });
      btn.style.background = '#8E6545';
      btn.style.color = '#FFFFFF';
      btn.style.borderColor = '#8E6545';
      btn.classList.add('selected');
      calculatePrice();
    }

    // Change quantity
    function changeQuantity(delta) {
      const input = document.getElementById('quantityInput');
      let value = parseInt(input.value) + delta;
      if (value < 1) value = 1;
      if (value > 99) value = 99;
      input.value = value;
      calculatePrice();
    }

    // Change accessory quantity
    function changeAccessoryQty(accessory, delta) {
      const inputId = accessory + 'Qty';
      const input = document.getElementById(inputId);
      if (!input) return;

      let value = parseInt(input.value) + delta;
      if (value < 0) value = 0;
      if (value > 10) value = 10;
      input.value = value;

      // Highlight the accessory item when quantity > 0
      const accessoryItem = input.closest('.accessory-item');
      if (accessoryItem) {
        if (value > 0) {
          accessoryItem.style.borderColor = '#8E6545';
          accessoryItem.style.boxShadow = '0 2px 8px rgba(142, 101, 69, 0.15)';
        } else {
          accessoryItem.style.borderColor = '#e5e5e5';
          accessoryItem.style.boxShadow = 'none';
        }
      }

      calculatePrice();
    }

    // Accessory prices - loaded dynamically from API, fallback to these defaults
    let accessoryPrices = {
      smartHub: 23.50,
      usbCharger: 5.00
    };

    // Update accessory prices from product options when loaded
    function updateAccessoryPrices() {
      if (productOptionsData && productOptionsData.accessories && productOptionsData.accessories.options) {
        productOptionsData.accessories.options.forEach(acc => {
          const key = acc.value.replace(/[^a-zA-Z0-9]/g, '');
          accessoryPrices[key] = acc.price || accessoryPrices[key] || 0;
        });

        // Update displayed prices in the UI
        const smartHubPriceEl = document.getElementById('smartHubPrice');
        const usbChargerPriceEl = document.getElementById('usbChargerPrice');
        if (smartHubPriceEl) smartHubPriceEl.textContent = '$' + accessoryPrices.smartHub.toFixed(2);
        if (usbChargerPriceEl) usbChargerPriceEl.textContent = '$' + accessoryPrices.usbCharger.toFixed(2);
      }
    }

    // Debounce timer for API calls
    let priceCalculationTimeout = null;
    let lastPricingResponse = null;

    // Calculate price by calling backend pricing API
    function calculatePrice() {
      // Debounce API calls (wait 300ms after last input)
      if (priceCalculationTimeout) {
        clearTimeout(priceCalculationTimeout);
      }

      priceCalculationTimeout = setTimeout(() => {
        calculatePriceFromAPI();
      }, 300);
    }

    // Actually call the pricing API
    async function calculatePriceFromAPI() {
      // Get dimensions (always in inches)
      let width = parseFloat(document.getElementById('widthInput').value) || 24;
      let height = parseFloat(document.getElementById('heightInput').value) || 36;

      // Convert to inches if not already
      width = width / conversionFactors[currentUnit];
      height = height / conversionFactors[currentUnit];

      const quantity = parseInt(document.getElementById('quantityInput').value) || 1;
      const warranty = document.getElementById('extendedWarranty').checked;

      // Get product slug from URL
      const productSlug = window.location.pathname.split('/').pop();

      // Determine product type from slug
      let productType = 'roller';
      if (productSlug.includes('zebra')) productType = 'zebra';
      else if (productSlug.includes('roman')) productType = 'roman';
      else if (productSlug.includes('honeycomb')) productType = 'honeycomb';

      // Get selected fabric code
      const fabricSwatch = document.querySelector('.fabric-group .fabric-swatch.selected');
      const fabricCode = fabricSwatch?.dataset.code || null;

      // Get control type
      const controlTypeOption = document.querySelector('#controlTypeSwatches .hardware-option.selected');
      let controlType = 'manual';
      if (controlTypeOption) {
        const ctValue = controlTypeOption.dataset.value || '';
        if (ctValue.includes('cordless')) controlType = 'cordless';
        else if (ctValue.includes('motor')) controlType = 'motorized';
      }

      // Get hardware options
      const cassetteOption = document.querySelector('#cassetteSwatches .hardware-option.selected');
      const bottomBarOption = document.querySelector('#bottomBarSwatches .hardware-option.selected');
      const rollerTypeOption = document.querySelector('#rollerTypeSwatches .hardware-option.selected');
      const mountTypeOption = document.querySelector('#mountTypeSwatches .hardware-option.selected');

      // Build options object
      const options = {
        controlType,
        standardCassette: cassetteOption?.dataset.value || null,
        standardBottomBar: bottomBarOption?.dataset.value || null,
        rollerType: rollerTypeOption?.dataset.value || null,
        mountType: mountTypeOption?.dataset.value || null,
        // Map hardware selectors to pricing engine option names
        valanceType: cassetteOption?.dataset.value || null,
        bottomRail: bottomBarOption?.dataset.value || null
      };

      // Motor brand, type and remote type if motorized
      const motorBrandOption = document.querySelector('#motorBrandSwatches .motor-brand-btn.selected');
      const motorTypeOption = document.querySelector('#motorTypeSwatches .motor-btn.selected');
      const remoteTypeOption = document.querySelector('#remoteTypeSwatches .remote-btn.selected');
      const solarTypeOption = document.querySelector('#solarTypeSwatches .solar-btn.selected');
      if (controlType === 'motorized') {
        options.motorBrand = motorBrandOption?.dataset.value || 'aok';
        options.motorType = motorTypeOption?.dataset.value || null;
        options.remoteType = remoteTypeOption?.dataset.value || null;
        options.solarType = solarTypeOption?.dataset.value || null;
      }

      // Accessories (Smart Hub, USB Charger)
      const smartHubQty = parseInt(document.getElementById('smartHubQty')?.value) || 0;
      const usbChargerQty = parseInt(document.getElementById('usbChargerQty')?.value) || 0;
      options.smartHubQty = smartHubQty;
      options.usbChargerQty = usbChargerQty;

      // Build API request
      const pricingRequest = {
        productSlug,
        productType,
        width,
        height,
        quantity,
        fabricCode,
        options,
        includeShipping: false,
        includeTax: false
      };

      try {
        const response = await fetch('/api/v1/pricing/calculate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(pricingRequest)
        });

        const result = await response.json();

        if (result.success) {
          lastPricingResponse = result;
          displayPricingResult(result, warranty, quantity);
        } else {
          console.error('Pricing API error:', result.error);
          // Fallback to basic calculation if API fails
          fallbackPriceCalculation(width, height, quantity, warranty);
        }
      } catch (error) {
        console.error('Failed to fetch pricing:', error);
        // Fallback to basic calculation if API fails
        fallbackPriceCalculation(width, height, quantity, warranty);
      }
    }

    // Display pricing result from API
    function displayPricingResult(result, warranty, quantity) {
      const breakdown = [];
      const pricing = result.pricing;

      // Base fabric price (manufacturer cost + margin = unit base price)
      const fabricBasePrice = pricing.manufacturerCost.unitCost + pricing.margin.amount;
      breakdown.push({
        name: `Fabric (${result.fabricCode || 'Standard'})`,
        price: fabricBasePrice
      });

      // Show area calculation if available
      if (result.dimensions.squareMeters) {
        const areaInfo = result.dimensions.minAreaApplied
          ? `Area: ${result.dimensions.squareMeters} m² (min applied)`
          : `Area: ${result.dimensions.squareMeters} m²`;
        breakdown.push({ name: areaInfo, price: 0, info: true });
      }

      // Light Filtering
      const lightFilterOption = document.querySelector('#lightFilteringSwatches .filter-toggle-btn.selected');
      if (lightFilterOption) {
        const lightFilterName = lightFilterOption.textContent.trim();
        breakdown.push({ name: `Light Filtering: ${lightFilterName}`, price: 0, info: true });
      }

      // Hardware options from API breakdown
      if (pricing.options && pricing.options.breakdown) {
        pricing.options.breakdown.forEach(opt => {
          // Format display name nicely
          let displayName = opt.name;
          // Capitalize first letter of each word
          displayName = displayName.split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
          // Add prefix based on type
          if (opt.type === 'motorization') displayName = 'Control Type: ' + displayName;
          else if (opt.type === 'motor_type') displayName = 'Motor Type: ' + displayName;
          else if (opt.type === 'remote') displayName = 'Remote: ' + displayName;
          else if (opt.type === 'mount_type') displayName = 'Mount Type: ' + displayName;
          else if (opt.type === 'valance_type') displayName = 'Valance: ' + displayName;
          else if (opt.type === 'bottom_rail') displayName = 'Bottom Rail: ' + displayName;

          if (opt.price > 0) {
            breakdown.push({ name: displayName, price: opt.price });
          } else {
            breakdown.push({ name: displayName, price: 0, info: true });
          }
        });
      }

      // Add hardware options prices from DOM (for items not in API response)
      const cassetteOption = document.querySelector('#cassetteSwatches .hardware-option.selected');
      const bottomBarOption = document.querySelector('#bottomBarSwatches .hardware-option.selected');
      const rollerTypeOption = document.querySelector('#rollerTypeSwatches .hardware-option.selected');
      const controlTypeOption = document.querySelector('#controlTypeSwatches .hardware-option.selected');
      const mountTypeOption = document.querySelector('#mountTypeSwatches .hardware-option.selected');

      let additionalOptionsTotal = 0;

      // Cassette/Valance - check if already in API breakdown
      const hasValanceInBreakdown = pricing.options?.breakdown?.some(o => o.type === 'valance_type');
      if (cassetteOption && !hasValanceInBreakdown) {
        const cassettePrice = parseFloat(cassetteOption.dataset.price) || 0;
        if (cassettePrice > 0) {
          additionalOptionsTotal += cassettePrice;
          breakdown.push({ name: `Valance: ${cassetteOption.querySelector('span')?.textContent.split('(')[0].trim() || 'Standard'}`, price: cassettePrice });
        }
      }
      // Bottom Bar/Rail - check if already in API breakdown
      const hasBottomRailInBreakdown = pricing.options?.breakdown?.some(o => o.type === 'bottom_rail');
      if (bottomBarOption && !hasBottomRailInBreakdown) {
        const bottomBarPrice = parseFloat(bottomBarOption.dataset.price) || 0;
        if (bottomBarPrice > 0) {
          additionalOptionsTotal += bottomBarPrice;
          breakdown.push({ name: `Bottom Rail: ${bottomBarOption.querySelector('span')?.textContent.split('(')[0].trim() || 'Standard'}`, price: bottomBarPrice });
        }
      }
      if (rollerTypeOption) {
        const rollerTypePrice = parseFloat(rollerTypeOption.dataset.price) || 0;
        if (rollerTypePrice > 0) {
          additionalOptionsTotal += rollerTypePrice;
          breakdown.push({ name: `Roller Type: ${rollerTypeOption.querySelector('span')?.textContent.split('(')[0].trim() || 'Standard'}`, price: rollerTypePrice });
        }
      }
      // Control type (motorization) is already in API breakdown, don't add again
      // Only add if API didn't include motorization
      const hasMotorizationInBreakdown = pricing.options?.breakdown?.some(o => o.type === 'motorization');
      if (controlTypeOption && !hasMotorizationInBreakdown) {
        const controlTypePrice = parseFloat(controlTypeOption.dataset.price) || 0;
        if (controlTypePrice > 0) {
          additionalOptionsTotal += controlTypePrice;
          breakdown.push({ name: `Control Type: ${controlTypeOption.querySelector('span')?.textContent.split('(')[0].trim() || 'Manual'}`, price: controlTypePrice });
        }
      }
      // Mount type is now included in API breakdown, check to avoid duplicates
      const hasMountInBreakdown = pricing.options?.breakdown?.some(o => o.type === 'mount_type');
      if (mountTypeOption && !hasMountInBreakdown) {
        const mountTypePrice = parseFloat(mountTypeOption.dataset.price) || 0;
        if (mountTypePrice > 0) {
          additionalOptionsTotal += mountTypePrice;
          breakdown.push({ name: `Mount Type: ${mountTypeOption.querySelector('span')?.textContent.split('(')[0].trim() || 'Inside'}`, price: mountTypePrice });
        }
      }

      // Motor Type and Remote Type are already included in API breakdown with prices
      // Only add them as info if they weren't in the API response
      const hasMotorInBreakdown = pricing.options?.breakdown?.some(o => o.type === 'motor_type' || o.type === 'motorization');
      const hasRemoteInBreakdown = pricing.options?.breakdown?.some(o => o.type === 'remote');

      const motorTypeOption = document.querySelector('#motorTypeSwatches .motor-btn.selected');
      if (motorTypeOption && motorTypeOption.dataset.value && !hasMotorInBreakdown) {
        breakdown.push({ name: `Motor: ${motorTypeOption.textContent.trim()}`, price: 0, info: true });
      }

      const remoteTypeOption = document.querySelector('#remoteTypeSwatches .remote-btn.selected');
      if (remoteTypeOption && remoteTypeOption.dataset.value && !hasRemoteInBreakdown) {
        breakdown.push({ name: `Remote: ${remoteTypeOption.textContent.trim()}`, price: 0, info: true });
      }

      // Chain Side
      const chainSideOption = document.querySelector('#chainLocationSwatches .chain-location-btn.selected');
      if (chainSideOption) {
        breakdown.push({ name: `Chain Position: ${chainSideOption.textContent.trim()}`, price: 0, info: true });
      }

      // Warranty
      let warrantyPrice = 0;
      if (warranty) {
        warrantyPrice = 15;
        breakdown.push({ name: '3-Year Extended Warranty', price: warrantyPrice });
      }

      // Quantity multiplier
      if (quantity > 1) {
        breakdown.push({ name: `Quantity: ${quantity}x`, price: 0, multiplier: true });
      }

      // Accessories are now included in API lineTotal (not multiplied by quantity)
      // Just display them from the API response
      if (pricing.accessories && pricing.accessories.breakdown) {
        pricing.accessories.breakdown.forEach(acc => {
          breakdown.push({ name: acc.name, price: acc.price });
        });
      }

      // Calculate total: API lineTotal already includes (unitPrice × qty) + accessories
      // Only add warranty (which is per-unit) and any additional DOM options
      const warrantyTotal = warrantyPrice * quantity;
      const additionalTotal = additionalOptionsTotal * quantity;
      const totalPrice = pricing.lineTotal + warrantyTotal + additionalTotal;

      document.getElementById('totalPrice').textContent = totalPrice.toFixed(2);
      updatePriceBreakdown(breakdown, totalPrice);

      // Log pricing details for debugging
      console.log('Pricing from API:', {
        fabricCode: result.fabricCode,
        dimensions: result.dimensions,
        manufacturerCost: pricing.manufacturerCost,
        margin: pricing.margin,
        unitPrice: pricing.unitPrice,
        lineTotal: pricing.lineTotal,
        accessories: pricing.accessories,
        displayTotal: totalPrice
      });
    }

    // Fallback price calculation if API fails
    function fallbackPriceCalculation(width, height, quantity, warranty) {
      const breakdown = [];

      // Size calculation using m² formula
      const INCHES_TO_METERS = 0.0254;
      const widthMeters = width * INCHES_TO_METERS;
      const heightMeters = height * INCHES_TO_METERS;
      let areaSqMeters = widthMeters * heightMeters;
      const minArea = 1.2; // Minimum 1.2 m² for roller blinds
      areaSqMeters = Math.max(areaSqMeters, minArea);

      // Approximate price per m² for fallback (fabric price)
      const pricePerSqMeter = 20; // Approximate customer price per m²
      let price = areaSqMeters * pricePerSqMeter;

      breakdown.push({
        name: `Fabric (${areaSqMeters.toFixed(2)} m²)`,
        price: price
      });

      // Get hardware option prices
      const cassetteOption = document.querySelector('#cassetteSwatches .hardware-option.selected');
      const bottomBarOption = document.querySelector('#bottomBarSwatches .hardware-option.selected');
      const rollerTypeOption = document.querySelector('#rollerTypeSwatches .hardware-option.selected');
      const controlTypeOption = document.querySelector('#controlTypeSwatches .hardware-option.selected');
      const mountTypeOption = document.querySelector('#mountTypeSwatches .hardware-option.selected');

      if (cassetteOption) {
        const cassettePrice = parseFloat(cassetteOption.dataset.price) || 0;
        price += cassettePrice;
        if (cassettePrice > 0) breakdown.push({ name: 'Cassette', price: cassettePrice });
      }
      if (bottomBarOption) {
        const bottomBarPrice = parseFloat(bottomBarOption.dataset.price) || 0;
        price += bottomBarPrice;
        if (bottomBarPrice > 0) breakdown.push({ name: 'Bottom Bar', price: bottomBarPrice });
      }
      if (rollerTypeOption) {
        const rollerTypePrice = parseFloat(rollerTypeOption.dataset.price) || 0;
        price += rollerTypePrice;
        if (rollerTypePrice > 0) breakdown.push({ name: 'Roller Type', price: rollerTypePrice });
      }
      if (controlTypeOption) {
        const controlTypePrice = parseFloat(controlTypeOption.dataset.price) || 0;
        price += controlTypePrice;
        if (controlTypePrice > 0) breakdown.push({ name: 'Control Type', price: controlTypePrice });
      }
      if (mountTypeOption) {
        const mountTypePrice = parseFloat(mountTypeOption.dataset.price) || 0;
        price += mountTypePrice;
        if (mountTypePrice > 0) breakdown.push({ name: 'Mount Type', price: mountTypePrice });
      }

      // Solar Panel
      const solarTypeOption = document.querySelector('#solarTypeSwatches .solar-btn.selected');
      if (solarTypeOption) {
        const solarPrice = parseFloat(solarTypeOption.dataset.price) || 0;
        price += solarPrice;
        if (solarPrice > 0) breakdown.push({ name: 'Solar Panel', price: solarPrice });
      }

      if (warranty) {
        price += 15;
        breakdown.push({ name: '3-Year Extended Warranty', price: 15 });
      }

      if (quantity > 1) {
        breakdown.push({ name: `Quantity: ${quantity}x`, price: 0, multiplier: true });
      }

      // Accessories
      let accessoriesTotal = 0;
      if (productOptionsData && productOptionsData.accessories && productOptionsData.accessories.options) {
        productOptionsData.accessories.options.forEach(opt => {
          const optionId = opt.value.replace(/[^a-zA-Z0-9]/g, '');
          const qtyInput = document.getElementById(`${optionId}Qty`);
          if (qtyInput) {
            const qty = parseInt(qtyInput.value) || 0;
            if (qty > 0) {
              const itemTotal = qty * opt.price;
              accessoriesTotal += itemTotal;
              breakdown.push({ name: `${opt.name} x${qty}`, price: itemTotal });
            }
          }
        });
      }

      const totalPrice = (price * quantity) + accessoriesTotal;
      document.getElementById('totalPrice').textContent = totalPrice.toFixed(2);
      updatePriceBreakdown(breakdown, totalPrice);
    }

    // Update price breakdown display
    function updatePriceBreakdown(breakdown, total) {
      const container = document.getElementById('breakdownItems');
      if (!container) return;

      let html = '';
      breakdown.forEach(item => {
        if (item.multiplier) {
          html += `<div style="display: flex; justify-content: space-between; padding: 6px 0; color: #8E6545; font-weight: 500;">
            <span><i class="fas fa-times" style="margin-right: 6px;"></i>${item.name}</span>
            <span>-</span>
          </div>`;
        } else if (item.info) {
          html += `<div style="display: flex; justify-content: space-between; padding: 6px 0; color: #888;">
            <span><i class="fas fa-check" style="margin-right: 6px; color: #28a745;"></i>${item.name}</span>
            <span style="color: #28a745;">Included</span>
          </div>`;
        } else {
          const priceDisplay = item.price > 0 ? `+$${item.price.toFixed(2)}` : (item.price < 0 ? `-$${Math.abs(item.price).toFixed(2)}` : '$0.00');
          const priceColor = item.price > 0 ? '#333' : (item.price < 0 ? '#28a745' : '#888');
          html += `<div style="display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #eee;">
            <span>${item.name}</span>
            <span style="font-weight: 500; color: ${priceColor};">${priceDisplay}</span>
          </div>`;
        }
      });

      container.innerHTML = html;
      document.getElementById('breakdownSubtotal').textContent = total.toFixed(2);
    }

    // Toggle price breakdown visibility
    function togglePriceBreakdown() {
      const details = document.getElementById('breakdownDetails');
      const icon = document.getElementById('breakdownToggleIcon');
      if (details.style.display === 'none') {
        details.style.display = 'block';
        icon.style.transform = 'rotate(0deg)';
      } else {
        details.style.display = 'none';
        icon.style.transform = 'rotate(-90deg)';
      }
    }

    // Add to cart
    async function addToCart() {
      const width = document.getElementById('widthInput').value;
      const height = document.getElementById('heightInput').value;
      const quantity = document.getElementById('quantityInput').value;
      const roomLabel = document.getElementById('roomLabel').value;
      const warranty = document.getElementById('extendedWarranty').checked;

      // Get accessory quantities
      const smartHubQty = parseInt(document.getElementById('smartHubQty')?.value) || 0;
      const usbChargerQty = parseInt(document.getElementById('usbChargerQty')?.value) || 0;

      // ============================================
      // VALIDATION - BUG-005 FIX
      // ============================================

      // Validate dimensions
      const widthNum = parseFloat(width);
      const heightNum = parseFloat(height);

      if (!width || isNaN(widthNum) || widthNum < 12 || widthNum > 120) {
        showToast('Please enter a valid width (12-120 inches)', 'error');
        document.getElementById('widthInput').focus();
        return;
      }

      if (!height || isNaN(heightNum) || heightNum < 12 || heightNum > 120) {
        showToast('Please enter a valid height (12-120 inches)', 'error');
        document.getElementById('heightInput').focus();
        return;
      }

      // Validate fabric selection
      const selectedFabric = document.querySelector('.fabric-group .fabric-swatch.selected');
      if (!selectedFabric) {
        showToast('Please select a fabric', 'error');
        return;
      }

      // Validate motorized options
      const controlType = document.querySelector('#controlTypeSwatches .hardware-option.selected')?.dataset.value || 'manual';

      if (controlType === 'motorized') {
        const motorBrand = document.querySelector('#motorBrandSwatches .motor-brand-btn.selected')?.dataset.value;
        const motorType = document.querySelector('#motorTypeSwatches .motor-btn.selected')?.dataset.value;

        if (!motorBrand) {
          showToast('Please select a motor brand for motorized blinds', 'error');
          return;
        }

        if (!motorType) {
          showToast('Please select a motor type for motorized blinds', 'error');
          return;
        }
      }

      // Validate price is calculated
      const totalPrice = parseFloat(document.getElementById('totalPrice').textContent);
      if (isNaN(totalPrice) || totalPrice <= 0) {
        showToast('Price calculation error. Please refresh and try again.', 'error');
        return;
      }

      // ============================================
      // END VALIDATION
      // ============================================

      const configuration = {
        lightFiltering: document.querySelector('#lightFilteringSwatches .filter-toggle-btn.selected')?.dataset.value || 'blackout',
        fabricCode: document.querySelector('.fabric-group .fabric-swatch.selected')?.dataset.code || '82143A',
        fabricColor: document.querySelector('.fabric-group .fabric-swatch.selected')?.dataset.color || '82143A',
        standardCassette: document.querySelector('#cassetteSwatches .hardware-option.selected')?.dataset.value || 'fabric-insert',
        standardBottomBar: document.querySelector('#bottomBarSwatches .hardware-option.selected')?.dataset.value || 'standard',
        chainSide: document.querySelector('#chainLocationSwatches .chain-location-btn.selected')?.dataset.value || 'left',
        rollerType: document.querySelector('#rollerTypeSwatches .hardware-option.selected')?.dataset.value || 'standard-roll-back',
        mountType: document.querySelector('#mountTypeSwatches .hardware-option.selected')?.dataset.value || 'inside',
        controlType: document.querySelector('#controlTypeSwatches .hardware-option.selected')?.dataset.value || 'manual',
        // Motor brand is critical for pricing - must match what pricing API uses
        motorBrand: document.querySelector('#motorBrandSwatches .motor-brand-btn.selected')?.dataset.value || '',
        motorType: document.querySelector('#motorTypeSwatches .motor-btn.selected')?.dataset.value || '',
        remoteType: document.querySelector('#remoteTypeSwatches .remote-btn.selected')?.dataset.value || '',
        solarType: document.querySelector('#solarTypeSwatches .solar-btn.selected')?.dataset.value || '',
        // Accessories
        smartHubQty: smartHubQty,
        usbChargerQty: usbChargerQty
      };

      // totalPrice already validated above
      const unitPrice = totalPrice / parseInt(quantity);

      const sessionId = getSessionId();

      try {
        const response = await fetch('/api/cart', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            sessionId,
            productId: product?.id || 'demo-product',
            quantity: parseInt(quantity),
            width: parseFloat(width),
            height: parseFloat(height),
            roomLabel,
            configuration,
            unitPrice,
            extendedWarranty: warranty
          })
        });

        const result = await response.json();
        if (result.success) {
          showToast('Added to cart!', 'success');
          updateCartCount();

          // TICKET 015: Track add to cart
          if (typeof trackEvent === 'function') {
            trackEvent('add_to_cart', {
              productId: product?.id,
              productName: product?.name,
              product_id: product?.id,
              product_name: product?.name,
              fabricCode: configuration.fabricCode,
              quantity: parseInt(quantity),
              value: totalPrice
            });
          }
        }
      } catch (error) {
        const cart = JSON.parse(localStorage.getItem('cart') || '[]');
        cart.push({
          id: Date.now().toString(),
          productId: product?.id || 'demo-product',
          productName: document.getElementById('productTitle').textContent,
          quantity: parseInt(quantity),
          width: parseFloat(width),
          height: parseFloat(height),
          roomLabel,
          configuration,
          unitPrice,
          extendedWarranty: warranty
        });
        localStorage.setItem('cart', JSON.stringify(cart));
        showToast('Added to cart!', 'success');
        updateCartCount();
      }
    }

    // Open quote modal
    function openQuoteModal() {
      document.getElementById('quoteModal').classList.add('active');
    }

    // Close quote modal
    function closeQuoteModal() {
      document.getElementById('quoteModal').classList.remove('active');
    }

    // Submit quote
    async function submitQuote(e) {
      e.preventDefault();
      const name = document.getElementById('quoteName').value;
      const email = document.getElementById('quoteEmail').value;
      const phone = document.getElementById('quotePhone').value;
      const message = document.getElementById('quoteMessage').value;

      try {
        const response = await fetch('/api/quotes', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            customerName: name,
            customerEmail: email,
            customerPhone: phone,
            productId: product?.id,
            productName: document.getElementById('productTitle').textContent,
            width: document.getElementById('widthInput').value,
            height: document.getElementById('heightInput').value,
            quantity: document.getElementById('quantityInput').value,
            message
          })
        });

        const result = await response.json();
        if (result.success) {
          showToast('Quote request submitted!', 'success');
          closeQuoteModal();
          document.getElementById('quoteForm').reset();
        }
      } catch (error) {
        showToast('Quote request submitted!', 'success');
        closeQuoteModal();
      }
    }

    // Toggle FAQ
    function toggleFaq(item) {
      item.classList.toggle('active');
    }

    // Toggle Product Details
    function toggleProductDetails(accordion) {
      accordion.classList.toggle('open');
      const icon = accordion.querySelector('.product-details-icon');
      if (accordion.classList.contains('open')) {
        icon.textContent = '−';
      } else {
        icon.textContent = '+';
      }
    }

    // Toggle Shades Dropdown
    function toggleShadesDropdown() {
      const dropdown = document.getElementById('selectShadesDropdown');
      dropdown.classList.toggle('open');
    }

    // Close dropdown when clicking outside
    document.addEventListener('click', function(e) {
      const dropdown = document.getElementById('selectShadesDropdown');
      if (dropdown && !dropdown.contains(e.target)) {
        dropdown.classList.remove('open');
      }
    });

    // Image Zoom Modal Functions
    let currentZoom = 1;
    const zoomStep = 0.25;
    const maxZoom = 3;
    const minZoom = 0.5;

    function openZoomModal(imageSrc, caption) {
      const modal = document.getElementById('zoomModal');
      const zoomImage = document.getElementById('zoomImage');
      const zoomCaption = document.getElementById('zoomCaption');

      zoomImage.src = imageSrc;
      zoomCaption.textContent = caption || '';
      currentZoom = 1;
      zoomImage.style.transform = `scale(${currentZoom})`;
      modal.classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeZoomModal(event) {
      if (event && event.target !== event.currentTarget) return;
      const modal = document.getElementById('zoomModal');
      modal.classList.remove('active');
      document.body.style.overflow = '';
      currentZoom = 1;
    }

    function zoomIn() {
      if (currentZoom < maxZoom) {
        currentZoom += zoomStep;
        document.getElementById('zoomImage').style.transform = `scale(${currentZoom})`;
      }
    }

    function zoomOut() {
      if (currentZoom > minZoom) {
        currentZoom -= zoomStep;
        document.getElementById('zoomImage').style.transform = `scale(${currentZoom})`;
      }
    }

    function resetZoom() {
      currentZoom = 1;
      document.getElementById('zoomImage').style.transform = `scale(${currentZoom})`;
    }

    // Close zoom modal on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeZoomModal();
      }
    });

    // Share product
    function shareProduct() {
      if (navigator.share) {
        navigator.share({
          title: document.getElementById('productTitle').textContent,
          url: window.location.href
        });
      } else {
        navigator.clipboard.writeText(window.location.href);
        showToast('Link copied!', 'success');
      }
    }

    // Load trending products
    async function loadTrendingProducts() {
      const productImages = [
        'https://images.unsplash.com/photo-1615874959474-d609969a20ed?w=400',
        'https://images.unsplash.com/photo-1616046229478-9901c5536a45?w=400',
        'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400',
        'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=400'
      ];

      const trendingProducts = [
        { name: 'Affordable Custom Roller Blinds & shades', price: 40.00, slug: 'affordable-custom-roller-blinds' },
        { name: 'Energy Efficient Roman Shades', price: 89.79, slug: 'energy-efficient-roman-shades' },
        { name: 'Affordable Custom Zebra Window Blinds', price: 50.00, slug: 'affordable-zebra-window-blinds' },
        { name: 'Affordable Custom Roller Blinds & shades', price: 40.00, slug: 'blackout-roller-blinds' }
      ];

      const grid = document.getElementById('trendsGrid');
      grid.innerHTML = trendingProducts.map((p, i) => `
        <div class="product-card" onclick="window.location.href='/product/${p.slug}'">
          <div class="product-card-image">
            <img src="${productImages[i]}" alt="${p.name}">
          </div>
          <div class="product-card-info">
            <h3 class="product-card-title">${p.name}</h3>
            <div class="product-card-price">$${p.price.toFixed(2)} USD</div>
          </div>
        </div>
      `).join('');
    }

    // Close modals on outside click
    document.getElementById('quoteModal').addEventListener('click', function(e) {
      if (e.target === this) closeQuoteModal();
    });

    // ============================================
    // IMAGE POSITION EDITOR - Press Ctrl+Shift+E to toggle
    // ============================================
    let imageEditorActive = false;
    let currentEditingImage = null;
    let editorPanel = null;

    // Create editor panel
    function createEditorPanel() {
      const panel = document.createElement('div');
      panel.id = 'imageEditorPanel';
      panel.innerHTML = `
        <style>
          #imageEditorPanel {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 320px;
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 10000;
            font-family: 'Montserrat', sans-serif;
            display: none;
          }
          #imageEditorPanel.active { display: block; }
          .editor-header {
            background: #8E6545;
            color: white;
            padding: 15px;
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
          }
          .editor-header h3 { margin: 0; font-size: 14px; }
          .editor-close { background: none; border: none; color: white; font-size: 20px; cursor: pointer; }
          .editor-body { padding: 15px; }
          .editor-info { background: #F6F1EB; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-size: 12px; color: #666; }
          .editor-label { font-size: 12px; font-weight: 600; color: #333; margin-bottom: 8px; display: block; }
          .editor-slider-group { margin-bottom: 15px; }
          .editor-slider { width: 100%; margin: 5px 0; }
          .editor-value { font-size: 11px; color: #8E6545; font-weight: 600; }
          .editor-preview {
            width: 100%; height: 120px; border: 2px dashed #ccc; border-radius: 8px;
            overflow: hidden; margin-bottom: 15px; background: #f5f5f5;
            display: flex; align-items: center; justify-content: center;
          }
          .editor-preview img { width: 100%; height: 100%; }
          .editor-btn {
            width: 100%; padding: 12px; background: #8E6545; color: white;
            border: none; border-radius: 8px; font-weight: 600; cursor: pointer;
            margin-bottom: 8px; font-size: 13px;
          }
          .editor-btn:hover { background: #7A5639; }
          .editor-btn.secondary { background: #E5E5E5; color: #333; }
          .editor-code {
            background: #1a1a1a; color: #4ade80; padding: 10px; border-radius: 8px;
            font-size: 11px; font-family: monospace; word-break: break-all; margin-top: 10px;
          }
          .editable-image {
            outline: 3px dashed #8E6545 !important;
            cursor: move !important;
            position: relative;
          }
          .editable-image::after {
            content: 'Click to Edit';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(142, 101, 69, 0.9);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            pointer-events: none;
          }
        </style>
        <div class="editor-header">
          <h3>🎨 Image Position Editor</h3>
          <button class="editor-close" onclick="toggleImageEditor()">&times;</button>
        </div>
        <div class="editor-body">
          <div class="editor-info">
            <strong>How to use:</strong><br>
            1. Click on any hardware image to select it<br>
            2. Use sliders to adjust position<br>
            3. Copy the generated CSS code
          </div>
          <div id="editorContent">
            <p style="text-align: center; color: #999; font-size: 13px;">Click on an image to start editing</p>
          </div>
        </div>
      `;
      document.body.appendChild(panel);
      return panel;
    }

    // Toggle editor mode
    function toggleImageEditor() {
      imageEditorActive = !imageEditorActive;

      if (!editorPanel) {
        editorPanel = createEditorPanel();
      }

      if (imageEditorActive) {
        editorPanel.classList.add('active');
        enableImageSelection();
        showToast('Image Editor Enabled - Click on images to edit', 'success');
      } else {
        editorPanel.classList.remove('active');
        disableImageSelection();
        showToast('Image Editor Disabled', 'info');
      }
    }

    // Enable image selection
    function enableImageSelection() {
      const images = document.querySelectorAll('.hardware-option img, .hardware-swatches img');
      images.forEach(img => {
        img.classList.add('editable-image');
        img.addEventListener('click', selectImageForEdit);
      });
    }

    // Disable image selection
    function disableImageSelection() {
      const images = document.querySelectorAll('.editable-image');
      images.forEach(img => {
        img.classList.remove('editable-image');
        img.removeEventListener('click', selectImageForEdit);
      });
      currentEditingImage = null;
    }

    // Select image for editing
    function selectImageForEdit(e) {
      e.preventDefault();
      e.stopPropagation();

      // Remove previous selection
      document.querySelectorAll('.editable-image.selected').forEach(img => {
        img.classList.remove('selected');
        img.style.outline = '3px dashed #8E6545';
      });

      currentEditingImage = e.target;
      currentEditingImage.classList.add('selected');
      currentEditingImage.style.outline = '3px solid #4ade80';

      // Get current object-position
      const style = window.getComputedStyle(currentEditingImage);
      let objectPosition = style.objectPosition || '50% 50%';
      let objectFit = style.objectFit || 'cover';

      // Parse position values
      const posMatch = objectPosition.match(/(\d+)%\s*(\d+)%/);
      let posX = posMatch ? parseInt(posMatch[1]) : 50;
      let posY = posMatch ? parseInt(posMatch[2]) : 50;

      // Update editor content
      const editorContent = document.getElementById('editorContent');
      editorContent.innerHTML = `
        <div class="editor-preview">
          <img id="previewImage" src="${currentEditingImage.src}" style="object-fit: ${objectFit}; object-position: ${posX}% ${posY}%;">
        </div>

        <div class="editor-slider-group">
          <label class="editor-label">Horizontal Position (X): <span class="editor-value" id="posXValue">${posX}%</span></label>
          <input type="range" class="editor-slider" id="posXSlider" min="0" max="100" value="${posX}" oninput="updateImagePosition()">
        </div>

        <div class="editor-slider-group">
          <label class="editor-label">Vertical Position (Y): <span class="editor-value" id="posYValue">${posY}%</span></label>
          <input type="range" class="editor-slider" id="posYSlider" min="0" max="100" value="${posY}" oninput="updateImagePosition()">
        </div>

        <div class="editor-slider-group">
          <label class="editor-label">Object Fit:</label>
          <select id="objectFitSelect" onchange="updateImagePosition()" style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ccc;">
            <option value="contain" ${objectFit === 'contain' ? 'selected' : ''}>Contain (show full image)</option>
            <option value="cover" ${objectFit === 'cover' ? 'selected' : ''}>Cover (fill container)</option>
            <option value="fill" ${objectFit === 'fill' ? 'selected' : ''}>Fill (stretch)</option>
          </select>
        </div>

        <button class="editor-btn" onclick="applyToImage()">✓ Apply Changes</button>
        <button class="editor-btn secondary" onclick="resetImage()">↺ Reset to Default</button>

        <div class="editor-code" id="generatedCode">
          object-fit: ${objectFit};<br>object-position: ${posX}% ${posY}%;
        </div>
        <button class="editor-btn secondary" onclick="copyCode()" style="margin-top: 8px;">📋 Copy CSS Code</button>
      `;
    }

    // Update image position in real-time
    function updateImagePosition() {
      if (!currentEditingImage) return;

      const posX = document.getElementById('posXSlider').value;
      const posY = document.getElementById('posYSlider').value;
      const objectFit = document.getElementById('objectFitSelect').value;

      document.getElementById('posXValue').textContent = posX + '%';
      document.getElementById('posYValue').textContent = posY + '%';

      // Update preview
      const preview = document.getElementById('previewImage');
      preview.style.objectPosition = `${posX}% ${posY}%`;
      preview.style.objectFit = objectFit;

      // Update actual image
      currentEditingImage.style.objectPosition = `${posX}% ${posY}%`;
      currentEditingImage.style.objectFit = objectFit;

      // Update code
      document.getElementById('generatedCode').innerHTML = `object-fit: ${objectFit};<br>object-position: ${posX}% ${posY}%;`;
    }

    // Apply changes
    function applyToImage() {
      if (!currentEditingImage) return;
      showToast('Changes applied! Copy the CSS code to make permanent.', 'success');
    }

    // Reset image
    function resetImage() {
      if (!currentEditingImage) return;
      currentEditingImage.style.objectPosition = '50% 50%';
      currentEditingImage.style.objectFit = 'contain';

      document.getElementById('posXSlider').value = 50;
      document.getElementById('posYSlider').value = 50;
      document.getElementById('objectFitSelect').value = 'contain';
      updateImagePosition();
    }

    // Copy generated code
    function copyCode() {
      const code = document.getElementById('generatedCode').innerText;
      navigator.clipboard.writeText(code);
      showToast('CSS code copied to clipboard!', 'success');
    }

    // Keyboard shortcut: Ctrl+Shift+E
    document.addEventListener('keydown', function(e) {
      if (e.ctrlKey && e.shiftKey && e.key === 'E') {
        e.preventDefault();
        toggleImageEditor();
      }
    });

    // Add edit button to page
    const editButton = document.createElement('button');
    editButton.innerHTML = '🎨 Edit Images';
    editButton.style.cssText = 'position: fixed; bottom: 20px; right: 20px; padding: 12px 20px; background: #8E6545; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; z-index: 9999; font-family: Montserrat, sans-serif; box-shadow: 0 4px 15px rgba(0,0,0,0.2);';
    editButton.onclick = toggleImageEditor;
    document.body.appendChild(editButton);
  </script>

  <!-- Fabric Zoom Modal -->
  <div id="fabricZoomModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 10001; align-items: center; justify-content: center;">
    <div style="position: relative; max-width: 90vw; max-height: 90vh; background: white; border-radius: 16px; padding: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
      <button onclick="closeFabricZoom()" style="position: absolute; top: 10px; right: 10px; width: 36px; height: 36px; border-radius: 50%; background: #f0f0f0; border: none; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; z-index: 10002;">&times;</button>
      <div id="zoomFabricCode" style="text-align: center; font-size: 18px; font-weight: 600; color: #333; margin-bottom: 15px;"></div>
      <img id="zoomFabricImage" src="" alt="Fabric Preview" style="max-width: 80vw; max-height: 70vh; border-radius: 12px; display: block; margin: 0 auto;">
      <div id="zoomFabricSpecs" style="text-align: center; margin-top: 15px; font-size: 14px; color: #666;"></div>
    </div>
  </div>

  <script>
    // Fabric Zoom Functions
    const fabricSpecsData = {
      // Will be populated from technical_specifications.json
    };

    function openFabricZoom(code, imageSrc, event) {
      event.stopPropagation();
      const modal = document.getElementById('fabricZoomModal');
      const img = document.getElementById('zoomFabricImage');
      const codeEl = document.getElementById('zoomFabricCode');
      const specsEl = document.getElementById('zoomFabricSpecs');

      img.src = imageSrc;
      codeEl.textContent = 'Fabric Code: ' + code;

      // Show modal
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    function closeFabricZoom() {
      const modal = document.getElementById('fabricZoomModal');
      modal.style.display = 'none';
      document.body.style.overflow = '';
    }

    // Close on background click
    document.getElementById('fabricZoomModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeFabricZoom();
      }
    });

    // Close on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeFabricZoom();
      }
    });

    // Add hover effect to show zoom buttons
    document.querySelectorAll('.fabric-swatch').forEach(swatch => {
      swatch.addEventListener('mouseenter', function() {
        const zoomBtn = this.querySelector('.zoom-btn');
        if (zoomBtn) zoomBtn.style.opacity = '1';
      });
      swatch.addEventListener('mouseleave', function() {
        const zoomBtn = this.querySelector('.zoom-btn');
        if (zoomBtn) zoomBtn.style.opacity = '0';
      });
    });
  </script>

  <style>
    /* Fabric Zoom Button Styles */
    .fabric-swatch .zoom-btn {
      position: absolute;
      top: 4px;
      right: 4px;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(255,255,255,0.95);
      border: 1px solid #ddd;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      opacity: 0;
      transition: opacity 0.2s, transform 0.2s;
      z-index: 10;
    }
    .fabric-swatch:hover .zoom-btn {
      opacity: 1;
    }
    .fabric-swatch .zoom-btn:hover {
      transform: scale(1.1);
      background: #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .swatch-img-container {
      position: relative;
      display: inline-block;
    }
  </style>

  <!-- Dynamic Content Loading from Admin Panel -->
  <script>
    // Load product content from API
    async function loadProductContent() {
      try {
        // Use fast combined endpoint - single request for all data
        const response = await fetch('/api/product-page-data');
        if (response.ok) {
          const data = await response.json();
          if (data.success) {
            // Render fabrics
            if (data.fabrics && data.fabrics.length > 0) {
              renderFabricsFromAPI(data.fabrics);
            }
            // Cache data for later use
            window.productPageData = data;
          }
        }

        // Load room labels
        const roomLabelsRes = await fetch('/api/room-labels');
        if (roomLabelsRes.ok) {
          const roomData = await roomLabelsRes.json();
          if (roomData.success && roomData.data && roomData.data.length > 0) {
            renderRoomLabels(roomData.data);
          }
        }
      } catch (error) {
        console.log('Using default content, API not available:', error.message);
      }
    }

    // Render fabrics from API data
    function renderFabricsFromAPI(fabrics) {
      const blackoutContainer = document.getElementById('blackoutFabrics');
      const semiBlackoutContainer = document.getElementById('semiBlackoutFabrics');
      const transparentContainer = document.getElementById('transparentFabrics');

      // Filter active fabrics by type
      const activeFabrics = fabrics.filter(f => f.isActive);
      const blackoutFabrics = activeFabrics.filter(f => f.filterType === 'blackout');
      const semiBlackoutFabrics = activeFabrics.filter(f => f.filterType === 'semi-blackout');
      const transparentFabrics = activeFabrics.filter(f => f.filterType === 'transparent');

      // Sort by sortOrder
      const sortByOrder = (a, b) => (a.sortOrder || 999) - (b.sortOrder || 999);

      // Render each category
      if (blackoutContainer && blackoutFabrics.length > 0) {
        blackoutContainer.innerHTML = blackoutFabrics.sort(sortByOrder).map(f => createFabricSwatchHTML(f)).join('');
        attachZoomHoverEvents(blackoutContainer);
      }

      if (semiBlackoutContainer && semiBlackoutFabrics.length > 0) {
        semiBlackoutContainer.innerHTML = semiBlackoutFabrics.sort(sortByOrder).map(f => createFabricSwatchHTML(f)).join('');
        attachZoomHoverEvents(semiBlackoutContainer);
      }

      if (transparentContainer && transparentFabrics.length > 0) {
        transparentContainer.innerHTML = transparentFabrics.sort(sortByOrder).map(f => createFabricSwatchHTML(f)).join('');
        attachZoomHoverEvents(transparentContainer);
      }
    }

    // Create HTML for a single fabric swatch
    function createFabricSwatchHTML(fabric) {
      const code = escapeHtml(fabric.code);
      const imageUrl = fabric.imageUrl;

      return `
        <div class="fabric-swatch" data-code="${code}" onclick="selectFabricSwatch(this, event)" style="width: 90px; text-align: center; cursor: pointer; position: relative;">
          <div class="swatch-img-container">
            <img src="${imageUrl}" alt="${code}" loading="lazy" decoding="async" style="width: 75px; height: 75px; border-radius: 8px; object-fit: cover; border: 2px solid transparent;" onerror="this.src='/images/placeholder.png'">
            <button type="button" class="zoom-btn" onclick="openFabricZoom('${code}', '${imageUrl}', event)" title="Zoom">🔍</button>
          </div>
          <span style="font-size: 10px; color: #5C4A3A; display: block; margin-top: 4px;">${code}</span>
        </div>
      `;
    }

    // Attach zoom hover events to fabric swatches
    function attachZoomHoverEvents(container) {
      container.querySelectorAll('.fabric-swatch').forEach(swatch => {
        swatch.addEventListener('mouseenter', function() {
          const zoomBtn = this.querySelector('.zoom-btn');
          if (zoomBtn) zoomBtn.style.opacity = '1';
        });
        swatch.addEventListener('mouseleave', function() {
          const zoomBtn = this.querySelector('.zoom-btn');
          if (zoomBtn) zoomBtn.style.opacity = '0';
        });
      });
    }

    // Render room labels dynamically
    function renderRoomLabels(labels) {
      const roomSelect = document.getElementById('roomLabel');
      if (roomSelect && labels.length > 0) {
        roomSelect.innerHTML = labels.map(label =>
          `<option value="${escapeHtml(label)}">${escapeHtml(label)}</option>`
        ).join('');
      }
    }

    // Escape HTML to prevent XSS
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Render product features
    function renderProductFeatures(items) {
      const container = document.getElementById('productFeatures');
      if (!container || !items || items.length === 0) return;

      container.innerHTML = items.map(item => `
        <div style="display: flex; align-items: center; gap: 8px; padding: 8px 14px; background: #fff; border: 1px solid #E8E4E0; border-radius: 20px; font-size: 13px; color: #333;">
          <i class="fas ${escapeHtml(item.icon || 'fa-check')}" style="color: #8E6545;"></i>
          <span>${escapeHtml(item.text || '')}</span>
        </div>
      `).join('');
      container.style.display = 'flex';
    }

    // Render trust badges
    function renderTrustBadges(items) {
      const container = document.getElementById('trustBadges');
      if (!container || !items || items.length === 0) return;

      container.innerHTML = items.map(item => `
        <div style="display: flex; align-items: center; gap: 10px; font-size: 13px; color: #333;">
          <i class="fas ${escapeHtml(item.icon || 'fa-shield-alt')}" style="color: #8E6545; font-size: 18px;"></i>
          <span>${escapeHtml(item.text || '')}</span>
        </div>
      `).join('');
      container.style.display = 'flex';
    }

    // Load content when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      loadProductContent();
      loadPageSections();
    });

    // Load page sections from the page builder
    async function loadPageSections() {
      try {
        const slug = window.location.pathname.split('/').pop();
        const response = await fetch(`/api/product-page-sections/${slug}`);
        if (response.ok) {
          const data = await response.json();
          if (data.success && data.sections) {
            applyPageSections(data.sections);
          }
        }
      } catch (error) {
        console.log('Page sections not available:', error.message);
      }
    }

    // Apply page sections to the product page
    function applyPageSections(sections) {
      sections.forEach(section => {
        if (!section.isVisible) return;

        switch (section.type) {
          case 'product-title':
            if (section.data?.title) {
              const titleEl = document.getElementById('productTitle');
              if (titleEl) titleEl.textContent = section.data.title;
            }
            if (section.data?.description) {
              const descEl = document.getElementById('productDescription');
              if (descEl) descEl.textContent = section.data.description;
            }
            break;

          case 'image-gallery':
            if (section.data?.mainImage || section.data?.images?.length > 0) {
              updateProductGalleryFromSections(section.data);
            }
            break;

          case 'features':
            if (section.data?.items && section.data.items.length > 0) {
              renderProductFeatures(section.data.items);
            }
            break;

          case 'trust-badges':
            if (section.data?.items && section.data.items.length > 0) {
              renderTrustBadges(section.data.items);
            }
            break;
        }
      });
    }

    // Update gallery from section data
    function updateProductGalleryFromSections(data) {
      const mainImageEl = document.getElementById('mainProductImage');
      const thumbnailColumn = document.querySelector('.thumbnail-column');

      const images = [];
      if (data.mainImage) images.push(data.mainImage);
      if (data.images && Array.isArray(data.images)) {
        images.push(...data.images.filter(Boolean));
      }

      if (images.length === 0) return;

      // Update main image
      if (mainImageEl) {
        mainImageEl.src = images[0];
      }

      // Update thumbnails
      if (thumbnailColumn && images.length > 0) {
        thumbnailColumn.innerHTML = images.slice(0, 4).map((img, i) => `
          <div class="thumb-item ${i === 0 ? 'active' : ''}" onclick="changeImage(this, '${img}')">
            <img src="${img}" alt="Thumbnail ${i + 1}">
          </div>
        `).join('');
      }
    }

    // Listen for messages from the page editor (for live preview)
    window.addEventListener('message', function(event) {
      if (event.data.type === 'UPDATE_PAGE_SECTIONS') {
        applyPageSections(event.data.sections);
      }
      if (event.data.type === 'HIGHLIGHT_SECTION') {
        // Could add visual highlighting of sections here
        console.log('Highlight section:', event.data.sectionId);
      }
    });
  </script>
</body>
</html>
